<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Quarto Basics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="hello_files/libs/clipboard/clipboard.min.js"></script>
<script src="hello_files/libs/quarto-html/quarto.js"></script>
<script src="hello_files/libs/quarto-html/popper.min.js"></script>
<script src="hello_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="hello_files/libs/quarto-html/anchor.min.js"></script>
<link href="hello_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="hello_files/libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="hello_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="hello_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="hello_files/libs/bootstrap/bootstrap-8a79a254b8e706d3c925cde0a310d4f0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Quarto Basics</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="project-goal" class="level2">
<h2 class="anchored" data-anchor-id="project-goal">Project Goal</h2>
<p>My project goal is to see how China’s trade patterns have adjusted over the course of the last 5 years with data available from China.</p>
<p>We will need to take the trading data available to us, combine it into a single master data set, then pull from that data set and create data frames in order to develop conclusions about the data.</p>
<p>We will first go over the data by grouping by continents. Thankfully, the master data set already has a grouping that categorizes all the countries by continent. So this data frame should be easier.</p>
<p>Now with this, we can develop some conclusions!</p>
<p>After that, we will introduce a control to see if this changes our data. This control will be global GDP growth from the last 5 years. If we control for global GDP growth, does this change our data at all?</p>
<p>After this, we will introduce our last data set, which is the democracy score. We will see how china’s trade with countries with any ordinal value of democracy score has been changing. Can we conclude anything from this?</p>
</section>
<section id="making-the-master-data-set" class="level2">
<h2 class="anchored" data-anchor-id="making-the-master-data-set">Making the Master Data Set</h2>
<p>In order to start, we have to make the Master data set.</p>
<p>How do we go about this?</p>
<p>Well first let’s go to our source.</p>
<p>The General Administration of Customs, People’s Republic of China website has a statistics page with all the information we need: http://english.customs.gov.cn/Statistics/Statistics?ColumnId=6</p>
<p>From here, we would select the year and download each months data set. We are doing 2019 January-2024 June. So it will a little over 60-65 excel sheets.</p>
<p>From here, we can order each of the excel sheets into a 5 folders labeled by fiscal year. From there, we can open up a new excel and enter into power query from the data tab. We can then combine and load them into a new fiscal year combination.</p>
<p>After this we can create another power query with the combined excels, from there, we can create some new columns that will properly group the data by month, then year.</p>
<p>Now we have our master data set!</p>
<p>Let’s get to data cleaning!</p>
</section>
<section id="cleaning-the-master-data-set-and-making-new-data-frames" class="level2">
<h2 class="anchored" data-anchor-id="cleaning-the-master-data-set-and-making-new-data-frames">Cleaning the Master Data Set and Making new Data Frames</h2>
<p>I will first show how I did it in google colab where I did my experimentation:</p>
<div id="2d680db0-67dd-43b9-b1c1-6e9df46f342e" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#import pandas as pd from google.colab </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#import drive drive.mount('/content/drive') </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#import os  </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Set the search parameters  </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Make sure to replace 'music1.xlsx' with actual name of your file in your directory file_path = '/content/drive/My Drive/Everything.xlsx'  </span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#df = pd.read_excel(file_path) # Use smaller data types where possible  </span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#print(df.head()) # View the first few rows print </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#(df.info()) # Check column types and missing values print </span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#(df.describe()) # Summarize numerical data  </span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#df = df.dropna() # Example: Drop rows with missing values </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now we can look at how it will be done in jupyter in this quarto document.</p>
<div id="939c0515-9e15-416a-a0b4-032b21d44ee4" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>file_path <span class="op">=</span> <span class="st">'C:/Users/jonca/Downloads/New Final Project/All Trade Information/Everything.xlsx'</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_excel(file_path) <span class="co"># Use smaller data types where possible</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.head()) <span class="co"># View the first few rows print</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>(df.info()) <span class="co"># Check column types and missing values print</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>(df.describe()) <span class="co"># Summarize numerical data </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna() <span class="co"># Example: Drop rows with missing values </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        Source Month  Month_num  Year  \
0  Jan_Feb.xls   Jan          1  2019   
1  Jan_Feb.xls   Jan          1  2019   
2  Jan_Feb.xls   Jan          1  2019   
3  Jan_Feb.xls   Jan          1  2019   
4  Jan_Feb.xls   Jan          1  2019   

                                      Country/region Total for Month  \
0  (2) Imports and Exports by Country (Region) of...             NaN   
1                                                NaN             NaN   
2                                   Country (Region)           Total   
3                                                NaN          1 to 2   
4                                              TOTAL     591,992,771   

  Total YTD Exports for Month        Exports YTD Imports for Month  \
0       NaN               NaN                NaN               NaN   
1       NaN               NaN                NaN               NaN   
2   Exports           Imports  Percentage Change               NaN   
3       NaN            1 to 2                NaN            1 to 2   
4       NaN       292,448,566                NaN       299,544,205   

          Imports YTD Percentage Change YoY Exports YoY change  \
0                 NaN                   NaN                NaN   
1      Unit: US$1,000                   NaN                NaN   
2                 NaN                   NaN                NaN   
3                 NaN                 Total            Exports   
4                 NaN                 -11.0              -17.2   

  Imports YoY change  
0                NaN  
1                NaN  
2                NaN  
3            Imports  
4               -4.0  
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 15576 entries, 0 to 15575
Data columns (total 14 columns):
 #   Column                 Non-Null Count  Dtype 
---  ------                 --------------  ----- 
 0   Source                 15576 non-null  object
 1   Month                  15576 non-null  object
 2   Month_num              15576 non-null  int64 
 3   Year                   15576 non-null  int64 
 4   Country/region         15269 non-null  object
 5   Total for Month        15210 non-null  object
 6   Total YTD              14901 non-null  object
 7   Exports for Month      15210 non-null  object
 8   Exports YTD            14901 non-null  object
 9   Imports for Month      15209 non-null  object
 10  Imports YTD            14901 non-null  object
 11  Percentage Change YoY  15209 non-null  object
 12  Exports YoY change     15209 non-null  object
 13  Imports YoY change     15151 non-null  object
dtypes: int64(2), object(12)
memory usage: 1.7+ MB</code></pre>
</div>
</div>
<p>We made it! We have a working master data set. Let’s get to work on the first analysis. We’ll start with Africa. Remember, we are trying to see if there is anything statistically significant about China’s trade with any of these regions of the world in the last 5 years.</p>
<p>What we will first do is filter the data by Region, only picking up the data points which are related to Africa.</p>
<p>After that, we’ll clean up the columns we will be using to measure and create some visualizations.</p>
<div id="8814a381-e5e2-4aba-91ee-12dc482aac47" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>africa_df <span class="op">=</span> df[(df[<span class="st">'Country/region'</span>] <span class="op">==</span> <span class="st">'Africa:'</span>) <span class="op">&amp;</span> (df[<span class="st">'Year'</span>].between(<span class="dv">2019</span>, <span class="dv">2025</span>))]</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>africa_df[<span class="st">'Year'</span>] <span class="op">=</span> pd.to_numeric(africa_df[<span class="st">'Year'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>africa_df <span class="op">=</span> africa_df.sort_values(by<span class="op">=</span><span class="st">'Year'</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>africa_df <span class="op">=</span> africa_df.dropna(subset<span class="op">=</span>[<span class="st">'Total for Month'</span>])</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>africa_df <span class="op">=</span> africa_df.dropna(subset<span class="op">=</span>[<span class="st">'Month_num'</span>])</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>africa_df <span class="op">=</span> africa_df.dropna(subset<span class="op">=</span>[<span class="st">'Exports for Month'</span>])</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>africa_df <span class="op">=</span> africa_df.dropna(subset<span class="op">=</span>[<span class="st">'Imports for Month'</span>])</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>africa_df</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(africa_df.columns)  <span class="co"># Check column names</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(africa_df[<span class="st">'Total for Month'</span>].head())  <span class="co"># Inspect the column values</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure it's treated as a string, remove commas and spaces, and convert to numeric</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>africa_df[<span class="st">'Total for Month'</span>] <span class="op">=</span> (</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    africa_df[<span class="st">'Total for Month'</span>]</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    .astype(<span class="bu">str</span>)  <span class="co"># Convert to string if it's not already</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">True</span>)  <span class="co"># Remove commas</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>.strip()  <span class="co"># Remove leading/trailing spaces</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>africa_df[<span class="st">'Total for Month'</span>] <span class="op">=</span> pd.to_numeric(africa_df[<span class="st">'Total for Month'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)  <span class="co"># Convert to numeric</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>africa_df <span class="op">=</span> africa_df.dropna(subset<span class="op">=</span>[<span class="st">'Total for Month'</span>])  <span class="co"># Drop rows where 'Total for Month:' is NaN</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(africa_df[<span class="st">'Exports for Month'</span>].head())  <span class="co"># Inspect the column values</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure it's treated as a string, remove commas and spaces, and convert to numeric</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>africa_df[<span class="st">'Exports for Month'</span>] <span class="op">=</span> (</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    africa_df[<span class="st">'Exports for Month'</span>]</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    .astype(<span class="bu">str</span>)  <span class="co"># Convert to string if it's not already</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">True</span>)  <span class="co"># Remove commas</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>.strip()  <span class="co"># Remove leading/trailing spaces</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>africa_df[<span class="st">'Exports for Month'</span>] <span class="op">=</span> pd.to_numeric(africa_df[<span class="st">'Exports for Month'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)  <span class="co"># Convert to numeric</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>africa_df <span class="op">=</span> africa_df.dropna(subset<span class="op">=</span>[<span class="st">'Exports for Month'</span>])  <span class="co"># Drop rows where 'Total for Month:' is NaN</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(africa_df[<span class="st">'Imports for Month'</span>].head())  <span class="co"># Inspect the column values</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure it's treated as a string, remove commas and spaces, and convert to numeric</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>africa_df[<span class="st">'Imports for Month'</span>] <span class="op">=</span> (</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    africa_df[<span class="st">'Imports for Month'</span>]</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    .astype(<span class="bu">str</span>)  <span class="co"># Convert to string if it's not already</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">True</span>)  <span class="co"># Remove commas</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>.strip()  <span class="co"># Remove leading/trailing spaces</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>africa_df[<span class="st">'Imports for Month'</span>] <span class="op">=</span> pd.to_numeric(africa_df[<span class="st">'Imports for Month'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)  <span class="co"># Convert to numeric</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>africa_df <span class="op">=</span> africa_df.dropna(subset<span class="op">=</span>[<span class="st">'Imports for Month'</span>])  <span class="co"># Drop rows where 'Total for Month:' is NaN</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\jonca\AppData\Local\Temp\ipykernel_3880\3427605775.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  africa_df['Year'] = pd.to_numeric(africa_df['Year'], errors='coerce')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['Source', 'Month', 'Month_num', 'Year', 'Country/region',
       'Total for Month', 'Total YTD', 'Exports for Month', 'Exports YTD',
       'Imports for Month', 'Imports YTD', 'Percentage Change YoY',
       'Exports YoY change', 'Imports YoY change'],
      dtype='object')
310     14,648,114
566     13,925,104
821     12,816,793
1077    14,516,751
1333    18,981,787
Name: Total for Month, dtype: object
310      7,724,990
566      8,728,377
821      8,755,322
1077     9,547,297
1333    10,459,876
Name: Exports for Month, dtype: object
310     6,923,125
566     5,196,727
821     4,061,471
1077    4,969,454
1333    8,521,911
Name: Imports for Month, dtype: object</code></pre>
</div>
</div>
</section>
<section id="analysis-part-1" class="level2">
<h2 class="anchored" data-anchor-id="analysis-part-1">Analysis Part 1</h2>
<p>Now that is done, lets first start with some exploratory statistics.</p>
<div id="8c46f783-6cab-4292-9f35-527d5562b279" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statistics</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.mean(africa_df[<span class="st">'Total for Month'</span>]))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.median(africa_df[<span class="st">'Total for Month'</span>]))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.stdev(africa_df[<span class="st">'Total for Month'</span>]))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.mean(africa_df[<span class="st">'Exports for Month'</span>]))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.median(africa_df[<span class="st">'Exports for Month'</span>]))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.stdev(africa_df[<span class="st">'Exports for Month'</span>]))</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.mean(africa_df[<span class="st">'Imports for Month'</span>]))</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.median(africa_df[<span class="st">'Imports for Month'</span>]))</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.stdev(africa_df[<span class="st">'Imports for Month'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>21276914.120689657
22136448.5
3854695.2326613143
12689192.931034483
13225265.0
2576085.664632353
8587721.327586208
8768622.5
1644272.293713047</code></pre>
</div>
</div>
</section>
<section id="analysis-part-2" class="level2">
<h2 class="anchored" data-anchor-id="analysis-part-2">Analysis Part 2</h2>
<p>It doesn’t seem like there is any conclusions we can draw from this summary statistics. Let’s move on to the plotting of the data to see if we can draw any conclusions!</p>
<div id="2ca4214b-a996-4a32-8058-664c60d27d22" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_month(month):</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>month<span class="sc">:02}</span><span class="ss">"</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>africa_df[<span class="st">'Year_Month'</span>] <span class="op">=</span> africa_df[<span class="st">'Year'</span>].astype(<span class="bu">str</span>) <span class="op">+</span> <span class="st">'_'</span> <span class="op">+</span> africa_df[<span class="st">'Month_num'</span>].<span class="bu">apply</span>(format_month)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>X_numeric <span class="op">=</span> np.arange(<span class="bu">len</span>(africa_df))  <span class="co"># Use a simple index as X-values</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> africa_df[<span class="st">'Year_Month'</span>]  <span class="co"># Use 'Year_Month' as X for plots</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot with regression line</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_with_regression(y_var, y_label, title):</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> africa_df[y_var]</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    slope, intercept <span class="op">=</span> np.polyfit(X_numeric, Y, <span class="dv">1</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    regression_line <span class="op">=</span> slope <span class="op">*</span> X_numeric <span class="op">+</span> intercept</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    plt.plot(X, Y, marker<span class="op">=</span><span class="st">'o'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, label<span class="op">=</span>y_label)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    plt.plot(X, regression_line, linestyle<span class="op">=</span><span class="st">'--'</span>, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'Regression Line'</span>)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Year_Month'</span>)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(y_label)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    plt.title(title)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Configure x-ticks: show only every third label</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    tick_positions <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="bu">len</span>(X), <span class="dv">3</span>)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    tick_labels <span class="op">=</span> X.iloc[tick_positions]</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    plt.xticks(ticks<span class="op">=</span>tick_positions, labels<span class="op">=</span>tick_labels, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    plt.grid(<span class="va">True</span>)</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot each variable with its regression line</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>plot_with_regression(<span class="st">'Total for Month'</span>, <span class="st">'Total for Month'</span>, <span class="st">'Year vs Total for Month'</span>)</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>plot_with_regression(<span class="st">'Exports for Month'</span>, <span class="st">'Exports for Month'</span>, <span class="st">'Year vs Exports for Month'</span>)</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>plot_with_regression(<span class="st">'Imports for Month'</span>, <span class="st">'Imports for Month'</span>, <span class="st">'Year vs Imports for Month'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-6-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-6-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-6-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We see somewhat of a seasonal drop of exports and on a lesser extent, imports on the 4th month of the year. That’s all that can really be pulled from these in my opinion. But if you see other things you can pull from this plot, then let me know.</p>
<div id="de983474-3ed5-4ea7-8057-7f30298c71d3" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> africa_df[[<span class="st">'Year'</span>]]  <span class="co"># Independent variable (assuming 'year' is clean)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> africa_df[<span class="st">'Total for Month'</span>]  <span class="co"># Dependent variable</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(X)  <span class="co"># Add a constant for the intercept</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> sm.OLS(Y, X).fit()</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:        Total for Month   R-squared:                       0.575
Model:                            OLS   Adj. R-squared:                  0.568
Method:                 Least Squares   F-statistic:                     75.83
Date:                Sun, 08 Dec 2024   Prob (F-statistic):           5.36e-12
Time:                        22:21:52   Log-Likelihood:                -936.52
No. Observations:                  58   AIC:                             1877.
Df Residuals:                      56   BIC:                             1881.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const      -4.199e+09   4.85e+08     -8.664      0.000   -5.17e+09   -3.23e+09
Year        2.088e+06    2.4e+05      8.708      0.000    1.61e+06    2.57e+06
==============================================================================
Omnibus:                        0.172   Durbin-Watson:                   1.575
Prob(Omnibus):                  0.918   Jarque-Bera (JB):                0.364
Skew:                          -0.070   Prob(JB):                        0.834
Kurtosis:                       2.638   Cond. No.                     2.94e+06
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 2.94e+06. This might indicate that there are
strong multicollinearity or other numerical problems.</code></pre>
</div>
</div>
<p>I did a regression to see if there was anything statistically significant here, and it didn’t seem so. Let’s move on. Now we are going to control for global gdp growth to see if any conclusions seem to pop up! ## Analysis Part 3</p>
<div id="d5faa20b-2d7f-437e-97bd-0d0f3f602938" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'Year_Month' to datetime</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>africa_df[<span class="st">'Date'</span>] <span class="op">=</span> pd.to_datetime(africa_df[<span class="st">'Year_Month'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">'%Y_%m'</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set 'Date' as index</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>africa_df.set_index(<span class="st">'Date'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure columns for aggregation are numeric</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>numeric_columns <span class="op">=</span> [<span class="st">'Total for Month'</span>, <span class="st">'Exports for Month'</span>, <span class="st">'Imports for Month'</span>]</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>africa_df[numeric_columns] <span class="op">=</span> africa_df[numeric_columns].<span class="bu">apply</span>(pd.to_numeric, errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for NaNs after conversion</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>africa_df.dropna(subset<span class="op">=</span>numeric_columns, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Resample and compute median only for the selected numeric columns</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>annual_median <span class="op">=</span> africa_df[numeric_columns].resample(<span class="st">'YE'</span>).median()</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Update the index to display only the year</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>annual_median.index <span class="op">=</span> annual_median.index.year</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Global GDP growth data for adjustment</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>gdp_growth <span class="op">=</span> {</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2019</span>: <span class="fl">2.64</span>,</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2020</span>: <span class="op">-</span><span class="fl">2.93</span>,</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2021</span>: <span class="fl">6.26</span>,</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2022</span>: <span class="fl">3.09</span>,</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2023</span>: <span class="fl">2.72</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize data by GDP growth</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> annual_median.index:</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> year <span class="kw">in</span> gdp_growth <span class="kw">and</span> gdp_growth[year] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        annual_median.loc[year] <span class="op">/=</span> gdp_growth[year]</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply a rolling window for smoothing</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>smoothed_data <span class="op">=</span> annual_median.rolling(window<span class="op">=</span><span class="dv">2</span>, min_periods<span class="op">=</span><span class="dv">1</span>).mean()</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting each metric separately</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">15</span>))</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to annotate each plot</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> annotate_points(ax, data, color):</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, (year, value) <span class="kw">in</span> <span class="bu">enumerate</span>(data.items()):</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>        ax.annotate(<span class="ss">f'</span><span class="sc">{</span>value<span class="sc">:.2f}</span><span class="ss">'</span>, (year, value), textcoords<span class="op">=</span><span class="st">"offset points"</span>,</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>                    xytext<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>), ha<span class="op">=</span><span class="st">'center'</span>, color<span class="op">=</span>color)</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Total for Month</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].plot(smoothed_data.index, smoothed_data[<span class="st">'Total for Month'</span>], marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_title(<span class="st">"Total for Month Adjusted for GDP Growth"</span>)</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_ylabel(<span class="st">'Trade Adjusted for GDP Growth'</span>)</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].grid(<span class="va">True</span>)</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>annotate_points(axs[<span class="dv">0</span>], smoothed_data[<span class="st">'Total for Month'</span>], <span class="st">'blue'</span>)</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Exports for Month</span></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].plot(smoothed_data.index, smoothed_data[<span class="st">'Exports for Month'</span>], marker<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">'orange'</span>)</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_title(<span class="st">"Exports for Month Adjusted for GDP Growth"</span>)</span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_ylabel(<span class="st">'Exports Adjusted for GDP Growth'</span>)</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].grid(<span class="va">True</span>)</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>annotate_points(axs[<span class="dv">1</span>], smoothed_data[<span class="st">'Exports for Month'</span>], <span class="st">'orange'</span>)</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Imports for Month</span></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].plot(smoothed_data.index, smoothed_data[<span class="st">'Imports for Month'</span>], marker<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_title(<span class="st">"Imports for Month Adjusted for GDP Growth"</span>)</span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_ylabel(<span class="st">'Imports Adjusted for GDP Growth'</span>)</span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].grid(<span class="va">True</span>)</span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>annotate_points(axs[<span class="dv">2</span>], smoothed_data[<span class="st">'Imports for Month'</span>], <span class="st">'green'</span>)</span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust layout to prevent overlap</span></span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>From here we can see that export data seem to be significantly more delicate than import data. The decline from export data is steeper and it’s ascension is steeper as well.</p>
<p>Now let’s compare these across regions!</p>
<div id="46c76163-a9fe-49a7-afcf-5183f412208d" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statistics</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming df is your initial DataFrame</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>europe_df <span class="op">=</span> df[(df[<span class="st">'Country/region'</span>] <span class="op">==</span> <span class="st">'Europe:'</span>) <span class="op">&amp;</span> (df[<span class="st">'Year'</span>].between(<span class="dv">2019</span>, <span class="dv">2025</span>))]</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>europe_df[<span class="st">'Year'</span>] <span class="op">=</span> pd.to_numeric(europe_df[<span class="st">'Year'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>europe_df <span class="op">=</span> europe_df.sort_values(by<span class="op">=</span><span class="st">'Year'</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>europe_df <span class="op">=</span> europe_df.dropna(subset<span class="op">=</span>[<span class="st">'Total for Month'</span>])</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>europe_df <span class="op">=</span> europe_df.dropna(subset<span class="op">=</span>[<span class="st">'Month_num'</span>])</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>europe_df <span class="op">=</span> europe_df.dropna(subset<span class="op">=</span>[<span class="st">'Exports for Month'</span>])</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>europe_df <span class="op">=</span> europe_df.dropna(subset<span class="op">=</span>[<span class="st">'Imports for Month'</span>])</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Check column names and inspect data</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(europe_df.columns) </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(europe_df[<span class="st">'Total for Month'</span>].head())</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'Total for Month' to numeric</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>europe_df[<span class="st">'Total for Month'</span>] <span class="op">=</span> (</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    europe_df[<span class="st">'Total for Month'</span>]</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    .astype(<span class="bu">str</span>)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>.strip()</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>europe_df[<span class="st">'Total for Month'</span>] <span class="op">=</span> pd.to_numeric(europe_df[<span class="st">'Total for Month'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>europe_df <span class="op">=</span> europe_df.dropna(subset<span class="op">=</span>[<span class="st">'Total for Month'</span>])</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'Exports for Month' to numeric</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(europe_df[<span class="st">'Exports for Month'</span>].head())</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>europe_df[<span class="st">'Exports for Month'</span>] <span class="op">=</span> (</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>    europe_df[<span class="st">'Exports for Month'</span>]</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    .astype(<span class="bu">str</span>)</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>.strip()</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>europe_df[<span class="st">'Exports for Month'</span>] <span class="op">=</span> pd.to_numeric(europe_df[<span class="st">'Exports for Month'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>europe_df <span class="op">=</span> europe_df.dropna(subset<span class="op">=</span>[<span class="st">'Exports for Month'</span>])</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'Imports for Month' to numeric</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(europe_df[<span class="st">'Imports for Month'</span>].head())</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>europe_df[<span class="st">'Imports for Month'</span>] <span class="op">=</span> (</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>    europe_df[<span class="st">'Imports for Month'</span>]</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>    .astype(<span class="bu">str</span>)</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>.strip()</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>europe_df[<span class="st">'Imports for Month'</span>] <span class="op">=</span> pd.to_numeric(europe_df[<span class="st">'Imports for Month'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>europe_df <span class="op">=</span> europe_df.dropna(subset<span class="op">=</span>[<span class="st">'Imports for Month'</span>])</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistics</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.mean(europe_df[<span class="st">'Total for Month'</span>]))</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.median(europe_df[<span class="st">'Total for Month'</span>]))</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.stdev(europe_df[<span class="st">'Total for Month'</span>]))</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.mean(europe_df[<span class="st">'Exports for Month'</span>]))</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.median(europe_df[<span class="st">'Exports for Month'</span>]))</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.stdev(europe_df[<span class="st">'Exports for Month'</span>]))</span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.mean(europe_df[<span class="st">'Imports for Month'</span>]))</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.median(europe_df[<span class="st">'Imports for Month'</span>]))</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.stdev(europe_df[<span class="st">'Imports for Month'</span>]))</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Format month and create 'Year_Month'</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_month(month):</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>month<span class="sc">:02}</span><span class="ss">"</span></span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>europe_df[<span class="st">'Year_Month'</span>] <span class="op">=</span> europe_df[<span class="st">'Year'</span>].astype(<span class="bu">str</span>) <span class="op">+</span> <span class="st">'_'</span> <span class="op">+</span> europe_df[<span class="st">'Month_num'</span>].<span class="bu">apply</span>(format_month)</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>X_numeric <span class="op">=</span> np.arange(<span class="bu">len</span>(europe_df))</span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> europe_df[<span class="st">'Year_Month'</span>]</span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot with regression line</span></span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_with_regression(y_var, y_label, title):</span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> europe_df[y_var]</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>    slope, intercept <span class="op">=</span> np.polyfit(X_numeric, Y, <span class="dv">1</span>)</span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>    regression_line <span class="op">=</span> slope <span class="op">*</span> X_numeric <span class="op">+</span> intercept</span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>    plt.plot(X, Y, marker<span class="op">=</span><span class="st">'o'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, label<span class="op">=</span>y_label)</span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>    plt.plot(X, regression_line, linestyle<span class="op">=</span><span class="st">'--'</span>, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'Regression Line'</span>)</span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Year_Month'</span>)</span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(y_label)</span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a>    plt.title(title)</span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>    tick_positions <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="bu">len</span>(X), <span class="dv">3</span>)</span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>    tick_labels <span class="op">=</span> X.iloc[tick_positions]</span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a>    plt.xticks(ticks<span class="op">=</span>tick_positions, labels<span class="op">=</span>tick_labels, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a>    plt.grid(<span class="va">True</span>)</span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with regression lines</span></span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a>plot_with_regression(<span class="st">'Total for Month'</span>, <span class="st">'Total for Month'</span>, <span class="st">'Year vs Total for Month'</span>)</span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a>plot_with_regression(<span class="st">'Exports for Month'</span>, <span class="st">'Exports for Month'</span>, <span class="st">'Year vs Exports for Month'</span>)</span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a>plot_with_regression(<span class="st">'Imports for Month'</span>, <span class="st">'Imports for Month'</span>, <span class="st">'Year vs Imports for Month'</span>)</span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true" tabindex="-1"></a><span class="co"># OLS Regression</span></span>
<span id="cb13-100"><a href="#cb13-100" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> europe_df[[<span class="st">'Year'</span>]]</span>
<span id="cb13-101"><a href="#cb13-101" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> europe_df[<span class="st">'Total for Month'</span>]</span>
<span id="cb13-102"><a href="#cb13-102" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(X)</span>
<span id="cb13-103"><a href="#cb13-103" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> sm.OLS(Y, X).fit()</span>
<span id="cb13-104"><a href="#cb13-104" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model.summary())</span>
<span id="cb13-105"><a href="#cb13-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-106"><a href="#cb13-106" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'Year_Month' to datetime and set as index</span></span>
<span id="cb13-107"><a href="#cb13-107" aria-hidden="true" tabindex="-1"></a>europe_df[<span class="st">'Date'</span>] <span class="op">=</span> pd.to_datetime(europe_df[<span class="st">'Year_Month'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">'%Y_%m'</span>)</span>
<span id="cb13-108"><a href="#cb13-108" aria-hidden="true" tabindex="-1"></a>europe_df.set_index(<span class="st">'Date'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-109"><a href="#cb13-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-110"><a href="#cb13-110" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure columns for aggregation are numeric</span></span>
<span id="cb13-111"><a href="#cb13-111" aria-hidden="true" tabindex="-1"></a>numeric_columns <span class="op">=</span> [<span class="st">'Total for Month'</span>, <span class="st">'Exports for Month'</span>, <span class="st">'Imports for Month'</span>]</span>
<span id="cb13-112"><a href="#cb13-112" aria-hidden="true" tabindex="-1"></a>europe_df[numeric_columns] <span class="op">=</span> europe_df[numeric_columns].<span class="bu">apply</span>(pd.to_numeric, errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb13-113"><a href="#cb13-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-114"><a href="#cb13-114" aria-hidden="true" tabindex="-1"></a>europe_df.dropna(subset<span class="op">=</span>numeric_columns, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-115"><a href="#cb13-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-116"><a href="#cb13-116" aria-hidden="true" tabindex="-1"></a><span class="co"># Annual median calculations</span></span>
<span id="cb13-117"><a href="#cb13-117" aria-hidden="true" tabindex="-1"></a>annual_median <span class="op">=</span> europe_df[numeric_columns].resample(<span class="st">'YE'</span>).median()</span>
<span id="cb13-118"><a href="#cb13-118" aria-hidden="true" tabindex="-1"></a>annual_median.index <span class="op">=</span> annual_median.index.year</span>
<span id="cb13-119"><a href="#cb13-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-120"><a href="#cb13-120" aria-hidden="true" tabindex="-1"></a><span class="co"># Global GDP growth data for adjustment</span></span>
<span id="cb13-121"><a href="#cb13-121" aria-hidden="true" tabindex="-1"></a>gdp_growth <span class="op">=</span> {<span class="dv">2019</span>: <span class="fl">2.64</span>, <span class="dv">2020</span>: <span class="op">-</span><span class="fl">2.93</span>, <span class="dv">2021</span>: <span class="fl">6.26</span>, <span class="dv">2022</span>: <span class="fl">3.09</span>, <span class="dv">2023</span>: <span class="fl">2.72</span>}</span>
<span id="cb13-122"><a href="#cb13-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-123"><a href="#cb13-123" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> annual_median.index:</span>
<span id="cb13-124"><a href="#cb13-124" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> year <span class="kw">in</span> gdp_growth <span class="kw">and</span> gdp_growth[year] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb13-125"><a href="#cb13-125" aria-hidden="true" tabindex="-1"></a>        annual_median.loc[year] <span class="op">/=</span> gdp_growth[year]</span>
<span id="cb13-126"><a href="#cb13-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-127"><a href="#cb13-127" aria-hidden="true" tabindex="-1"></a>smoothed_data <span class="op">=</span> annual_median.rolling(window<span class="op">=</span><span class="dv">2</span>, min_periods<span class="op">=</span><span class="dv">1</span>).mean()</span>
<span id="cb13-128"><a href="#cb13-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-129"><a href="#cb13-129" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb13-130"><a href="#cb13-130" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">15</span>))</span>
<span id="cb13-131"><a href="#cb13-131" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> annotate_points(ax, data, color):</span>
<span id="cb13-132"><a href="#cb13-132" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, (year, value) <span class="kw">in</span> <span class="bu">enumerate</span>(data.items()):</span>
<span id="cb13-133"><a href="#cb13-133" aria-hidden="true" tabindex="-1"></a>        ax.annotate(<span class="ss">f'</span><span class="sc">{</span>value<span class="sc">:.2f}</span><span class="ss">'</span>, (year, value), textcoords<span class="op">=</span><span class="st">"offset points"</span>,</span>
<span id="cb13-134"><a href="#cb13-134" aria-hidden="true" tabindex="-1"></a>                    xytext<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>), ha<span class="op">=</span><span class="st">'center'</span>, color<span class="op">=</span>color)</span>
<span id="cb13-135"><a href="#cb13-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-136"><a href="#cb13-136" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].plot(smoothed_data.index, smoothed_data[<span class="st">'Total for Month'</span>], marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb13-137"><a href="#cb13-137" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_title(<span class="st">"Total for Month Adjusted for GDP Growth"</span>)</span>
<span id="cb13-138"><a href="#cb13-138" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb13-139"><a href="#cb13-139" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_ylabel(<span class="st">'Trade Adjusted for GDP Growth'</span>)</span>
<span id="cb13-140"><a href="#cb13-140" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].grid(<span class="va">True</span>)</span>
<span id="cb13-141"><a href="#cb13-141" aria-hidden="true" tabindex="-1"></a>annotate_points(axs[<span class="dv">0</span>], smoothed_data[<span class="st">'Total for Month'</span>], <span class="st">'blue'</span>)</span>
<span id="cb13-142"><a href="#cb13-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-143"><a href="#cb13-143" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].plot(smoothed_data.index, smoothed_data[<span class="st">'Exports for Month'</span>], marker<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">'orange'</span>)</span>
<span id="cb13-144"><a href="#cb13-144" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_title(<span class="st">"Exports for Month Adjusted for GDP Growth"</span>)</span>
<span id="cb13-145"><a href="#cb13-145" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb13-146"><a href="#cb13-146" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_ylabel(<span class="st">'Exports Adjusted for GDP Growth'</span>)</span>
<span id="cb13-147"><a href="#cb13-147" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].grid(<span class="va">True</span>)</span>
<span id="cb13-148"><a href="#cb13-148" aria-hidden="true" tabindex="-1"></a>annotate_points(axs[<span class="dv">1</span>], smoothed_data[<span class="st">'Exports for Month'</span>], <span class="st">'orange'</span>)</span>
<span id="cb13-149"><a href="#cb13-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-150"><a href="#cb13-150" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].plot(smoothed_data.index, smoothed_data[<span class="st">'Imports for Month'</span>], marker<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb13-151"><a href="#cb13-151" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_title(<span class="st">"Imports for Month Adjusted for GDP Growth"</span>)</span>
<span id="cb13-152"><a href="#cb13-152" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb13-153"><a href="#cb13-153" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_ylabel(<span class="st">'Imports Adjusted for GDP Growth'</span>)</span>
<span id="cb13-154"><a href="#cb13-154" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].grid(<span class="va">True</span>)</span>
<span id="cb13-155"><a href="#cb13-155" aria-hidden="true" tabindex="-1"></a>annotate_points(axs[<span class="dv">2</span>], smoothed_data[<span class="st">'Imports for Month'</span>], <span class="st">'green'</span>)</span>
<span id="cb13-156"><a href="#cb13-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-157"><a href="#cb13-157" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb13-158"><a href="#cb13-158" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['Source', 'Month', 'Month_num', 'Year', 'Country/region',
       'Total for Month', 'Total YTD', 'Exports for Month', 'Exports YTD',
       'Imports for Month', 'Imports YTD', 'Percentage Change YoY',
       'Exports YoY change', 'Imports YoY change'],
      dtype='object')
372     63,539,431
628     69,714,419
883     70,919,072
1139    75,741,850
1395    75,594,395
Name: Total for Month, dtype: object
372     33,257,403
628     42,660,072
883     46,408,096
1139    46,422,624
1395    44,778,928
Name: Exports for Month, dtype: object
372     30,282,027
628     27,054,347
883     24,510,977
1139    29,319,227
1395    30,815,467
Name: Imports for Month, dtype: object
94443995.5862069
98635218.5
13121895.65687232
56122113.06896552
57908192.5
8633309.900465557
38321882.51724138
39908139.0
5228567.690341682</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\jonca\AppData\Local\Temp\ipykernel_3880\2678165451.py:9: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  europe_df['Year'] = pd.to_numeric(europe_df['Year'], errors='coerce')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-9-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-9-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-9-output-5.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:        Total for Month   R-squared:                       0.522
Model:                            OLS   Adj. R-squared:                  0.514
Method:                 Least Squares   F-statistic:                     61.26
Date:                Sun, 08 Dec 2024   Prob (F-statistic):           1.49e-10
Time:                        22:21:53   Log-Likelihood:                -1011.0
No. Observations:                  58   AIC:                             2026.
Df Residuals:                      56   BIC:                             2030.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const       -1.36e+10   1.75e+09     -7.773      0.000   -1.71e+10   -1.01e+10
Year        6.774e+06   8.66e+05      7.827      0.000    5.04e+06    8.51e+06
==============================================================================
Omnibus:                        0.367   Durbin-Watson:                   0.995
Prob(Omnibus):                  0.832   Jarque-Bera (JB):                0.280
Skew:                           0.164   Prob(JB):                        0.870
Kurtosis:                       2.909   Cond. No.                     2.94e+06
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 2.94e+06. This might indicate that there are
strong multicollinearity or other numerical problems.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-9-output-7.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="e5be51e8-bbbe-4e47-8aa0-b1912b7f5bf3" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statistics</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Verify unique values (optional, for debugging)</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">'Country/region'</span>].unique())</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Filter the DataFrame for North America</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>north_america_df <span class="op">=</span> df[</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'Country/region'</span>].<span class="bu">str</span>.contains(<span class="st">'North America:'</span>, case<span class="op">=</span><span class="va">False</span>, na<span class="op">=</span><span class="va">False</span>) <span class="op">&amp;</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'Year'</span>].between(<span class="dv">2019</span>, <span class="dv">2024</span>)  <span class="co"># Adjust year range if needed</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>].copy()</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Convert 'Year' to numeric</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>north_america_df[<span class="st">'Year'</span>] <span class="op">=</span> pd.to_numeric(north_america_df[<span class="st">'Year'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Sort by 'Year'</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>north_america_df <span class="op">=</span> north_america_df.sort_values(by<span class="op">=</span><span class="st">'Year'</span>)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Drop rows with NaN in 'Total for Month'</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>north_america_df <span class="op">=</span> north_america_df.dropna(subset<span class="op">=</span>[<span class="st">'Total for Month'</span>])</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Inspect column names and values (optional, for debugging)</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(north_america_df.columns)</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(north_america_df[<span class="st">'Total for Month'</span>].head())</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 7: Clean and convert 'Total for Month' to numeric</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>north_america_df[<span class="st">'Total for Month'</span>] <span class="op">=</span> (</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    north_america_df[<span class="st">'Total for Month'</span>]</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    .astype(<span class="bu">str</span>)</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>.strip()</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>north_america_df[<span class="st">'Total for Month'</span>] <span class="op">=</span> pd.to_numeric(north_america_df[<span class="st">'Total for Month'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>north_america_df <span class="op">=</span> north_america_df.dropna(subset<span class="op">=</span>[<span class="st">'Total for Month'</span>])</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeat similar cleaning for 'Exports for Month' and 'Imports for Month'</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>columns_to_clean <span class="op">=</span> [<span class="st">'Exports for Month'</span>, <span class="st">'Imports for Month'</span>]</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> columns_to_clean:</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(north_america_df[column].head())  <span class="co"># Inspect the column values</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>    north_america_df[column] <span class="op">=</span> (</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>        north_america_df[column]</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>        .astype(<span class="bu">str</span>)</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">str</span>.strip()</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>    north_america_df[column] <span class="op">=</span> pd.to_numeric(north_america_df[column], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>    north_america_df <span class="op">=</span> north_america_df.dropna(subset<span class="op">=</span>[column])</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate statistics</span></span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.mean(north_america_df[<span class="st">'Total for Month'</span>]))</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.median(north_america_df[<span class="st">'Total for Month'</span>]))</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.stdev(north_america_df[<span class="st">'Total for Month'</span>]))</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.mean(north_america_df[<span class="st">'Exports for Month'</span>]))</span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.median(north_america_df[<span class="st">'Exports for Month'</span>]))</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.stdev(north_america_df[<span class="st">'Exports for Month'</span>]))</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.mean(north_america_df[<span class="st">'Imports for Month'</span>]))</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.median(north_america_df[<span class="st">'Imports for Month'</span>]))</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics.stdev(north_america_df[<span class="st">'Imports for Month'</span>]))</span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 'Year_Month' for plotting</span></span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>north_america_df[<span class="st">'Year_Month'</span>] <span class="op">=</span> north_america_df[<span class="st">'Year'</span>].astype(<span class="bu">str</span>) <span class="op">+</span> <span class="st">'_'</span> <span class="op">+</span> north_america_df[<span class="st">'Month_num'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f"</span><span class="sc">{</span>x<span class="sc">:02}</span><span class="ss">"</span>)</span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>X_numeric <span class="op">=</span> np.arange(<span class="bu">len</span>(north_america_df))</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> north_america_df[<span class="st">'Year_Month'</span>]</span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot with regression line</span></span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_with_regression(y_var, y_label, title):</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> north_america_df[y_var]</span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>    slope, intercept <span class="op">=</span> np.polyfit(X_numeric, Y, <span class="dv">1</span>)</span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>    regression_line <span class="op">=</span> slope <span class="op">*</span> X_numeric <span class="op">+</span> intercept</span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>    plt.plot(X, Y, marker<span class="op">=</span><span class="st">'o'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, label<span class="op">=</span>y_label)</span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>    plt.plot(X, regression_line, linestyle<span class="op">=</span><span class="st">'--'</span>, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'Regression Line'</span>)</span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Year_Month'</span>)</span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(y_label)</span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>    plt.title(title)</span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>    tick_positions <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="bu">len</span>(X), <span class="bu">max</span>(<span class="dv">1</span>, <span class="bu">len</span>(X)<span class="op">//</span><span class="dv">10</span>))  <span class="co"># Adjust tick frequency</span></span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>    tick_labels <span class="op">=</span> X.iloc[tick_positions]</span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>    plt.xticks(ticks<span class="op">=</span>tick_positions, labels<span class="op">=</span>tick_labels, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>    plt.grid(<span class="va">True</span>)</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot each variable with its regression line</span></span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>plot_with_regression(<span class="st">'Total for Month'</span>, <span class="st">'Total for Month'</span>, <span class="st">'Year vs Total for Month'</span>)</span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a>plot_with_regression(<span class="st">'Exports for Month'</span>, <span class="st">'Exports for Month'</span>, <span class="st">'Year vs Exports for Month'</span>)</span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a>plot_with_regression(<span class="st">'Imports for Month'</span>, <span class="st">'Imports for Month'</span>, <span class="st">'Year vs Imports for Month'</span>)</span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a><span class="co"># OLS Regression</span></span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> north_america_df[[<span class="st">'Year'</span>]]</span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> north_america_df[<span class="st">'Total for Month'</span>]</span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(X)</span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> sm.OLS(Y, X).fit()</span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model.summary())</span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'Year_Month' to datetime and set as index</span></span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a>north_america_df[<span class="st">'Date'</span>] <span class="op">=</span> pd.to_datetime(north_america_df[<span class="st">'Year_Month'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">'%Y_%m'</span>)</span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a>north_america_df.set_index(<span class="st">'Date'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure columns for aggregation are numeric</span></span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a>numeric_columns <span class="op">=</span> [<span class="st">'Total for Month'</span>, <span class="st">'Exports for Month'</span>, <span class="st">'Imports for Month'</span>]</span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a>north_america_df[numeric_columns] <span class="op">=</span> north_america_df[numeric_columns].<span class="bu">apply</span>(pd.to_numeric, errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a>north_america_df.dropna(subset<span class="op">=</span>numeric_columns, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a><span class="co"># Resample and compute median only for the selected numeric columns</span></span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a>annual_median <span class="op">=</span> north_america_df[numeric_columns].resample(<span class="st">'YE'</span>).median()</span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a>annual_median.index <span class="op">=</span> annual_median.index.year</span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a><span class="co"># Global GDP growth data for adjustment</span></span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a>gdp_growth <span class="op">=</span> {<span class="dv">2019</span>: <span class="fl">2.64</span>, <span class="dv">2020</span>: <span class="op">-</span><span class="fl">2.93</span>, <span class="dv">2021</span>: <span class="fl">6.26</span>, <span class="dv">2022</span>: <span class="fl">3.09</span>, <span class="dv">2023</span>: <span class="fl">2.72</span>}</span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> annual_median.index:</span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> year <span class="kw">in</span> gdp_growth <span class="kw">and</span> gdp_growth[year] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a>        annual_median.loc[year] <span class="op">/=</span> gdp_growth[year]</span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a>smoothed_data <span class="op">=</span> annual_median.rolling(window<span class="op">=</span><span class="dv">2</span>, min_periods<span class="op">=</span><span class="dv">1</span>).mean()</span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">15</span>))</span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> annotate_points(ax, data, color):</span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, (year, value) <span class="kw">in</span> <span class="bu">enumerate</span>(data.items()):</span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a>        ax.annotate(<span class="ss">f'</span><span class="sc">{</span>value<span class="sc">:.2f}</span><span class="ss">'</span>, (year, value), textcoords<span class="op">=</span><span class="st">"offset points"</span>,</span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a>                    xytext<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>), ha<span class="op">=</span><span class="st">'center'</span>, color<span class="op">=</span>color)</span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].plot(smoothed_data.index, smoothed_data[<span class="st">'Total for Month'</span>], marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_title(<span class="st">"Total for Month Adjusted for GDP Growth"</span>)</span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_ylabel(<span class="st">'Trade Adjusted for GDP Growth'</span>)</span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].grid(<span class="va">True</span>)</span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a>annotate_points(axs[<span class="dv">0</span>], smoothed_data[<span class="st">'Total for Month'</span>], <span class="st">'blue'</span>)</span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].plot(smoothed_data.index, smoothed_data[<span class="st">'Exports for Month'</span>], marker<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">'orange'</span>)</span>
<span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_title(<span class="st">"Exports for Month Adjusted for GDP Growth"</span>)</span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_ylabel(<span class="st">'Exports Adjusted for GDP Growth'</span>)</span>
<span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].grid(<span class="va">True</span>)</span>
<span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a>annotate_points(axs[<span class="dv">1</span>], smoothed_data[<span class="st">'Exports for Month'</span>], <span class="st">'orange'</span>)</span>
<span id="cb17-144"><a href="#cb17-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-145"><a href="#cb17-145" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].plot(smoothed_data.index, smoothed_data[<span class="st">'Imports for Month'</span>], marker<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb17-146"><a href="#cb17-146" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_title(<span class="st">"Imports for Month Adjusted for GDP Growth"</span>)</span>
<span id="cb17-147"><a href="#cb17-147" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb17-148"><a href="#cb17-148" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_ylabel(<span class="st">'Imports Adjusted for GDP Growth'</span>)</span>
<span id="cb17-149"><a href="#cb17-149" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].grid(<span class="va">True</span>)</span>
<span id="cb17-150"><a href="#cb17-150" aria-hidden="true" tabindex="-1"></a>annotate_points(axs[<span class="dv">2</span>], smoothed_data[<span class="st">'Imports for Month'</span>], <span class="st">'green'</span>)</span>
<span id="cb17-151"><a href="#cb17-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-152"><a href="#cb17-152" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-153"><a href="#cb17-153" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>['TOTAL' 'Asia:' 'Afghanistan ' 'Bahrian ' 'Bangladesh' 'Bhutan' 'Brunei'
 'Myanmar ' 'Cambodia' 'Cyprus' 'Korea,DPR ' 'China Hong Kong' 'India'
 'Indonesia' 'Iran' 'Iraq' 'Israel' 'Japan' 'Jordan' 'Kuwait ' 'Lao PDR'
 'Lebanon' 'China Macau ' 'Malaysia' 'Maldives' 'Mongolia' 'Nepal,FDR'
 'Oman' 'Pakistan' 'Palestine' 'Philippines' 'Qatar' 'Saudi Arabia '
 'Singapore ' 'Korea,Rep.' 'Sri Lanka' 'Syrian Arab Republic' 'Thailand'
 'Turkey' 'United Arab Emirates' 'Yemen' 'Viet Nam' 'China' 'China Taiwan'
 'Timor-Leste ' 'Kazakhstan' 'Kyrgyzstan' 'Tajikistan' 'Turkmenistan'
 'Uzbekistan' 'Oth.Asia nes' 'Africa:' 'Algeria' 'Angola' 'Benin'
 'Botswana' 'Burundi' 'Cameroon' 'Canary Islands' 'Cape Verde '
 'Central African Rep.' 'Ceuta' 'Chad' 'Comoros' 'Congo' 'Djibouti'
 'Egypt ' 'Equatorial Guinea' 'Ethiopia ' 'Gabon' 'Gambia ' 'Ghana'
 'Guinea' 'Guinea-Bissau' "Cote d'Ivoire" 'Kenya' 'Liberia'
 'Libyan Arab Jamahiriya' 'Madagascar' 'Malawi' 'Mali ' 'Mauritania'
 'Mauritius' 'Morocco' 'Mozambique' 'Namibia' 'Niger' 'Nigeria ' 'Reunion'
 'Rwanda' 'Sao Tome and Principe' 'Senegal' 'Seychelles' 'Sierra Leone'
 'Somalia ' 'South Africa' 'Western Sahara ' 'Sudan' 'Tanzania' 'Togo '
 'Tunisia' 'Uganda' 'Burkina Faso' 'Congo,DR ' 'Zambia' 'Zimbabwe'
 'Lesotho' 'Melilla' 'Swaziland' 'Eritrea' 'Mayotte'
 'Republic of South Sudan' 'Oth.Afr.nes' 'Europe:' 'Belgium' 'Denmark'
 'United Kingdom' 'Germany' 'France ' 'Ireland' 'Italy' 'Luxembourg '
 'Netherlands' 'Greece' 'Portugal' 'Spain ' 'Albania' 'Andorra' 'Austria '
 'Bulgaria ' 'Finland' 'Gibraltar  ' 'Hungary ' 'Iceland' 'Liechtenstein '
 'Malta' 'Monaco' 'Norway' 'Poland' 'Romania ' 'San Marino' 'Sweden '
 'Switzerland' 'Estonia' 'Latvia ' 'Lithuania' 'Georgia ' 'Armenia '
 'Azerbaijan ' 'Belarus' 'Moldova' 'Russian Federation ' 'Ukraine'
 'Slovenia ' 'Croatia' 'Czech Republic' 'Slovakia'
 'Republic of North Macedonia' 'Bosnia and Hercegovina'
 'Vatican City State' 'Faroe Islands ' 'Serbia' 'Montenegro' 'Oth.Eur.nes'
 'Latin America:  ' 'Antigua and Barbuda' 'Argentina' 'Aruba' 'Bahamas'
 'Barbados' 'Belize' 'Bolivia' 'Bonaire' 'Brazil' 'Cayman Islands '
 'Chile ' 'Colombia ' 'Dominica' 'Costa Rica ' 'Cuba ' 'Curacao'
 'Dominican Republic' 'Ecuador' 'French Guiana' 'Grenada' 'Guadeloupe'
 'Guatemala ' 'Guyana' 'Haiti' 'Honduras' 'Jamaica' 'Martinique' 'Mexico'
 'Montserrat' 'Nicaragua' 'Panama ' 'Paraguay' 'Peru' 'Puerto Rico '
 'Saba' 'Saint Lucia' 'Saint Martin Islands' 'St.Vincent&amp;Grenadines'
 'El Salvador' 'Suriname' 'Trinidad and Tobago ' 'Turks&amp;Caicos Islands'
 'Uruguay' 'Venezuela ' 'Virgin Islands,British' 'St.Kitts&amp;Nevis'
 'St.Pierre&amp;Miquelon' 'Netherlands Antilles' 'Oth.L.Amer.nes '
 'North America: ' 'Canada ' 'United States' 'Greenland' 'Bermuda '
 'Oth.N.Amer.nes' 'Oceania: ' 'Australia ' 'Cook Islands' 'Fiji'
 'Gambier Islands' 'Marquesas Islands ' 'Nauru ' 'New Caledonia' 'Vanuatu'
 'New Zealand' 'Norfolk Island' 'Papua New Guinea ' 'Society Islands'
 'Solomon Islands ' 'Tonga' 'Tuamotu Islands ' 'Tubai Islands' 'Samoa'
 'Kiribati' 'Tuvalu ' 'Micronesia,FS' 'Marshall Islands ' 'Palau '
 'French Polynesia' 'Wallis and Futuna' 'Oth.Ocean.nes'
 'Countries(reg.)unknown ' 'ASEAN' 'EU ' 'APEC' 'Hong Kong，China'
 'Macao，China' 'Taiwan，China' 'Bahrain'
 "Democratic People's Republic of Korea" 'Hong Kong, China' 'Lao'
 'Macao, China' 'Nepal' 'Republic of Korea' 'Syria' 'Türkiye' 'Georgia'
 'Armenia' 'Azerbaijan' 'Other Asian Territories' 'Cabo Verde'
 'Central African Republic' 'Libya' 'Réunion'
 'Democratic Republic of Congo' 'Eswatini（Swaziland）' 'South Sudan'
 'French Southern Territories' 'British Indian Ocean Territory'
 'Saint Helena' 'Other African Territories' 'Russia'
 'Czechia（Czech Republic）' 'North Macedonia' 'Bosnia and Herzegovina'
 'Holy See' 'Åland Islands' 'Guernsey' 'Isle of Man' 'Jersey'
 'Svalbard and Jan Mayen Islands' 'Other European Territories' 'Curaçao'
 'Saint Martin (French Part)' 'Saint Vincent and the Grenadines'
 'Turks and Caicos Islands' 'British Virgin Islands'
 'Saint Kitts and Nevis' 'Bonaire, Sint Eustatius and Saba'
 'Saint Barthélemy' 'Bouvet Island' 'Falkland Islands (Malvinas)'
 'South Georgia and the South Sandwich Islands'
 'Sint Maarten (Dutch part)' 'United States Virgin Islands' 'Anguilla'
 'Other Latin American Territories' 'Saint Pierre and Miquelon'
 'Other North American Territories' 'The Federated States of Micronesia'
 'American Samoa' 'Cocos (Keeling) Islands' 'Christmas Island' 'Guam'
 'Heard Island and McDonald Islands' 'Northern Mariana Islands' 'Niue'
 'Pitcairn' 'Tokelau' 'United States Minor Outlying Islands'
 'Other Oceanian Territories' 'Antarctica' 'Countries（Territories）Unknown']
Index(['Source', 'Month', 'Month_num', 'Year', 'Country/region',
       'Total for Month', 'Total YTD', 'Exports for Month', 'Exports YTD',
       'Imports for Month', 'Imports YTD', 'Percentage Change YoY',
       'Exports YoY change', 'Imports YoY change'],
      dtype='object')
473     39,219,871
729     45,875,458
984     51,605,036
1240    56,090,792
1496    55,262,306
Name: Total for Month, dtype: object
473     27,552,603
729     35,062,217
984     40,524,636
1240    43,794,196
1496    42,299,572
Name: Exports for Month, dtype: object
473     11,667,268
729     10,813,241
984     11,080,400
1240    12,296,596
1496    12,962,734
Name: Imports for Month, dtype: object
64171848.25862069
64846752.5
9263977.15405581
47666985.9137931
47859693.0
7606618.868707712
16504862.431034483
16808259.0
2740825.9556985074</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-10-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-10-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-10-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:        Total for Month   R-squared:                       0.138
Model:                            OLS   Adj. R-squared:                  0.123
Method:                 Least Squares   F-statistic:                     8.977
Date:                Sun, 08 Dec 2024   Prob (F-statistic):            0.00407
Time:                        22:21:54   Log-Likelihood:                -1007.9
No. Observations:                  58   AIC:                             2020.
Df Residuals:                      56   BIC:                             2024.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const      -4.907e+09   1.66e+09     -2.958      0.005   -8.23e+09   -1.58e+09
Year         2.46e+06   8.21e+05      2.996      0.004    8.15e+05     4.1e+06
==============================================================================
Omnibus:                        0.096   Durbin-Watson:                   0.717
Prob(Omnibus):                  0.953   Jarque-Bera (JB):                0.019
Skew:                          -0.033   Prob(JB):                        0.990
Kurtosis:                       2.939   Cond. No.                     2.94e+06
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 2.94e+06. This might indicate that there are
strong multicollinearity or other numerical problems.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-10-output-6.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="06ff4b6c-b124-406f-a9e4-d0d2d0b7a335" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statistics</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Verify unique values (optional, for debugging)</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">'Country/region'</span>].unique())</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Filter the DataFrame for Latin America</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>latin_america_df <span class="op">=</span> df[</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'Country/region'</span>].<span class="bu">str</span>.contains(<span class="st">'Latin America:'</span>, case<span class="op">=</span><span class="va">False</span>, na<span class="op">=</span><span class="va">False</span>) <span class="op">&amp;</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'Year'</span>].between(<span class="dv">2019</span>, <span class="dv">2024</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>].copy()</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Convert 'Year' to numeric</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>latin_america_df[<span class="st">'Year'</span>] <span class="op">=</span> pd.to_numeric(latin_america_df[<span class="st">'Year'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Sort by 'Year'</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>latin_america_df <span class="op">=</span> latin_america_df.sort_values(by<span class="op">=</span><span class="st">'Year'</span>)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Drop rows with NaN in 'Total for Month'</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>latin_america_df <span class="op">=</span> latin_america_df.dropna(subset<span class="op">=</span>[<span class="st">'Total for Month'</span>])</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Inspect column names and values (optional, for debugging)</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(latin_america_df.columns)</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(latin_america_df[<span class="st">'Total for Month'</span>].head())</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 7: Clean and convert 'Total for Month' to numeric</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>latin_america_df[<span class="st">'Total for Month'</span>] <span class="op">=</span> (</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    latin_america_df[<span class="st">'Total for Month'</span>]</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    .astype(<span class="bu">str</span>)</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>.strip()</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>latin_america_df[<span class="st">'Total for Month'</span>] <span class="op">=</span> pd.to_numeric(latin_america_df[<span class="st">'Total for Month'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>latin_america_df <span class="op">=</span> latin_america_df.dropna(subset<span class="op">=</span>[<span class="st">'Total for Month'</span>])</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeat similar cleaning for 'Exports for Month' and 'Imports for Month'</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> [<span class="st">'Exports for Month'</span>, <span class="st">'Imports for Month'</span>]:</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(latin_america_df[column].head())  <span class="co"># Inspect the column values</span></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>    latin_america_df[column] <span class="op">=</span> (</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>        latin_america_df[column]</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>        .astype(<span class="bu">str</span>)</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">str</span>.strip()</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>    latin_america_df[column] <span class="op">=</span> pd.to_numeric(latin_america_df[column], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>    latin_america_df <span class="op">=</span> latin_america_df.dropna(subset<span class="op">=</span>[column])</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate statistics</span></span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Total for Month: Mean = </span><span class="sc">{:.2f}</span><span class="st">, Median = </span><span class="sc">{:.2f}</span><span class="st">, Std Dev = </span><span class="sc">{:.2f}</span><span class="st">"</span>.<span class="bu">format</span>(</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>    statistics.mean(latin_america_df[<span class="st">'Total for Month'</span>]),</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>    statistics.median(latin_america_df[<span class="st">'Total for Month'</span>]),</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>    statistics.stdev(latin_america_df[<span class="st">'Total for Month'</span>])</span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Exports for Month: Mean = </span><span class="sc">{:.2f}</span><span class="st">, Median = </span><span class="sc">{:.2f}</span><span class="st">, Std Dev = </span><span class="sc">{:.2f}</span><span class="st">"</span>.<span class="bu">format</span>(</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>    statistics.mean(latin_america_df[<span class="st">'Exports for Month'</span>]),</span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>    statistics.median(latin_america_df[<span class="st">'Exports for Month'</span>]),</span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>    statistics.stdev(latin_america_df[<span class="st">'Exports for Month'</span>])</span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Imports for Month: Mean = </span><span class="sc">{:.2f}</span><span class="st">, Median = </span><span class="sc">{:.2f}</span><span class="st">, Std Dev = </span><span class="sc">{:.2f}</span><span class="st">"</span>.<span class="bu">format</span>(</span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>    statistics.mean(latin_america_df[<span class="st">'Imports for Month'</span>]),</span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>    statistics.median(latin_america_df[<span class="st">'Imports for Month'</span>]),</span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>    statistics.stdev(latin_america_df[<span class="st">'Imports for Month'</span>])</span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 'Year_Month' for plotting</span></span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>latin_america_df[<span class="st">'Year_Month'</span>] <span class="op">=</span> latin_america_df[<span class="st">'Year'</span>].astype(<span class="bu">str</span>) <span class="op">+</span> <span class="st">'_'</span> <span class="op">+</span> latin_america_df[<span class="st">'Month_num'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f"</span><span class="sc">{</span>x<span class="sc">:02}</span><span class="ss">"</span>)</span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>X_numeric <span class="op">=</span> np.arange(<span class="bu">len</span>(latin_america_df))</span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> latin_america_df[<span class="st">'Year_Month'</span>]</span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot with regression line</span></span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_with_regression(y_var, y_label, title):</span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> latin_america_df[y_var]</span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true" tabindex="-1"></a>    slope, intercept <span class="op">=</span> np.polyfit(X_numeric, Y, <span class="dv">1</span>)</span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true" tabindex="-1"></a>    regression_line <span class="op">=</span> slope <span class="op">*</span> X_numeric <span class="op">+</span> intercept</span>
<span id="cb20-79"><a href="#cb20-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-80"><a href="#cb20-80" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb20-81"><a href="#cb20-81" aria-hidden="true" tabindex="-1"></a>    plt.plot(X, Y, marker<span class="op">=</span><span class="st">'o'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, label<span class="op">=</span>y_label)</span>
<span id="cb20-82"><a href="#cb20-82" aria-hidden="true" tabindex="-1"></a>    plt.plot(X, regression_line, linestyle<span class="op">=</span><span class="st">'--'</span>, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'Regression Line'</span>)</span>
<span id="cb20-83"><a href="#cb20-83" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Year_Month'</span>)</span>
<span id="cb20-84"><a href="#cb20-84" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(y_label)</span>
<span id="cb20-85"><a href="#cb20-85" aria-hidden="true" tabindex="-1"></a>    plt.title(title)</span>
<span id="cb20-86"><a href="#cb20-86" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-87"><a href="#cb20-87" aria-hidden="true" tabindex="-1"></a>    tick_positions <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="bu">len</span>(X), <span class="bu">max</span>(<span class="dv">1</span>, <span class="bu">len</span>(X)<span class="op">//</span><span class="dv">10</span>))  <span class="co"># Adjust tick frequency</span></span>
<span id="cb20-88"><a href="#cb20-88" aria-hidden="true" tabindex="-1"></a>    tick_labels <span class="op">=</span> X.iloc[tick_positions]</span>
<span id="cb20-89"><a href="#cb20-89" aria-hidden="true" tabindex="-1"></a>    plt.xticks(ticks<span class="op">=</span>tick_positions, labels<span class="op">=</span>tick_labels, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb20-90"><a href="#cb20-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-91"><a href="#cb20-91" aria-hidden="true" tabindex="-1"></a>    plt.grid(<span class="va">True</span>)</span>
<span id="cb20-92"><a href="#cb20-92" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb20-93"><a href="#cb20-93" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb20-94"><a href="#cb20-94" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb20-95"><a href="#cb20-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-96"><a href="#cb20-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot each variable with its regression line</span></span>
<span id="cb20-97"><a href="#cb20-97" aria-hidden="true" tabindex="-1"></a>plot_with_regression(<span class="st">'Total for Month'</span>, <span class="st">'Total for Month'</span>, <span class="st">'Year vs Total for Month in Latin America'</span>)</span>
<span id="cb20-98"><a href="#cb20-98" aria-hidden="true" tabindex="-1"></a>plot_with_regression(<span class="st">'Exports for Month'</span>, <span class="st">'Exports for Month'</span>, <span class="st">'Year vs Exports for Month in Latin America'</span>)</span>
<span id="cb20-99"><a href="#cb20-99" aria-hidden="true" tabindex="-1"></a>plot_with_regression(<span class="st">'Imports for Month'</span>, <span class="st">'Imports for Month'</span>, <span class="st">'Year vs Imports for Month in Latin America'</span>)</span>
<span id="cb20-100"><a href="#cb20-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-101"><a href="#cb20-101" aria-hidden="true" tabindex="-1"></a><span class="co"># OLS Regression</span></span>
<span id="cb20-102"><a href="#cb20-102" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> latin_america_df[[<span class="st">'Year'</span>]]</span>
<span id="cb20-103"><a href="#cb20-103" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> latin_america_df[<span class="st">'Total for Month'</span>]</span>
<span id="cb20-104"><a href="#cb20-104" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(X)</span>
<span id="cb20-105"><a href="#cb20-105" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> sm.OLS(Y, X).fit()</span>
<span id="cb20-106"><a href="#cb20-106" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model.summary())</span>
<span id="cb20-107"><a href="#cb20-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-108"><a href="#cb20-108" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'Year_Month' to datetime and set as index</span></span>
<span id="cb20-109"><a href="#cb20-109" aria-hidden="true" tabindex="-1"></a>latin_america_df[<span class="st">'Date'</span>] <span class="op">=</span> pd.to_datetime(latin_america_df[<span class="st">'Year_Month'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">'%Y_%m'</span>)</span>
<span id="cb20-110"><a href="#cb20-110" aria-hidden="true" tabindex="-1"></a>latin_america_df.set_index(<span class="st">'Date'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-111"><a href="#cb20-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-112"><a href="#cb20-112" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure columns for aggregation are numeric</span></span>
<span id="cb20-113"><a href="#cb20-113" aria-hidden="true" tabindex="-1"></a>numeric_columns <span class="op">=</span> [<span class="st">'Total for Month'</span>, <span class="st">'Exports for Month'</span>, <span class="st">'Imports for Month'</span>]</span>
<span id="cb20-114"><a href="#cb20-114" aria-hidden="true" tabindex="-1"></a>latin_america_df[numeric_columns] <span class="op">=</span> latin_america_df[numeric_columns].<span class="bu">apply</span>(pd.to_numeric, errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb20-115"><a href="#cb20-115" aria-hidden="true" tabindex="-1"></a>latin_america_df.dropna(subset<span class="op">=</span>numeric_columns, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-116"><a href="#cb20-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-117"><a href="#cb20-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Resample and compute median only for the selected numeric columns</span></span>
<span id="cb20-118"><a href="#cb20-118" aria-hidden="true" tabindex="-1"></a>annual_median <span class="op">=</span> latin_america_df[numeric_columns].resample(<span class="st">'Y'</span>).median()</span>
<span id="cb20-119"><a href="#cb20-119" aria-hidden="true" tabindex="-1"></a>annual_median.index <span class="op">=</span> annual_median.index.year</span>
<span id="cb20-120"><a href="#cb20-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-121"><a href="#cb20-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Global GDP growth data for adjustment</span></span>
<span id="cb20-122"><a href="#cb20-122" aria-hidden="true" tabindex="-1"></a>gdp_growth <span class="op">=</span> {<span class="dv">2019</span>: <span class="fl">2.64</span>, <span class="dv">2020</span>: <span class="op">-</span><span class="fl">2.93</span>, <span class="dv">2021</span>: <span class="fl">6.26</span>, <span class="dv">2022</span>: <span class="fl">3.09</span>, <span class="dv">2023</span>: <span class="fl">2.72</span>}</span>
<span id="cb20-123"><a href="#cb20-123" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> annual_median.index:</span>
<span id="cb20-124"><a href="#cb20-124" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> year <span class="kw">in</span> gdp_growth <span class="kw">and</span> gdp_growth[year] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb20-125"><a href="#cb20-125" aria-hidden="true" tabindex="-1"></a>        annual_median.loc[year] <span class="op">/=</span> gdp_growth[year]</span>
<span id="cb20-126"><a href="#cb20-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-127"><a href="#cb20-127" aria-hidden="true" tabindex="-1"></a>smoothed_data <span class="op">=</span> annual_median.rolling(window<span class="op">=</span><span class="dv">2</span>, min_periods<span class="op">=</span><span class="dv">1</span>).mean()</span>
<span id="cb20-128"><a href="#cb20-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-129"><a href="#cb20-129" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb20-130"><a href="#cb20-130" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">15</span>))</span>
<span id="cb20-131"><a href="#cb20-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-132"><a href="#cb20-132" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> annotate_points(ax, data, color):</span>
<span id="cb20-133"><a href="#cb20-133" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, (year, value) <span class="kw">in</span> <span class="bu">enumerate</span>(data.items()):</span>
<span id="cb20-134"><a href="#cb20-134" aria-hidden="true" tabindex="-1"></a>        ax.annotate(<span class="ss">f'</span><span class="sc">{</span>value<span class="sc">:.2f}</span><span class="ss">'</span>, (year, value), textcoords<span class="op">=</span><span class="st">"offset points"</span>,</span>
<span id="cb20-135"><a href="#cb20-135" aria-hidden="true" tabindex="-1"></a>                    xytext<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>), ha<span class="op">=</span><span class="st">'center'</span>, color<span class="op">=</span>color)</span>
<span id="cb20-136"><a href="#cb20-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-137"><a href="#cb20-137" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].plot(smoothed_data.index, smoothed_data[<span class="st">'Total for Month'</span>], marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb20-138"><a href="#cb20-138" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_title(<span class="st">"Total for Month Adjusted for GDP Growth in Latin America"</span>)</span>
<span id="cb20-139"><a href="#cb20-139" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb20-140"><a href="#cb20-140" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_ylabel(<span class="st">'Trade Adjusted for GDP Growth'</span>)</span>
<span id="cb20-141"><a href="#cb20-141" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].grid(<span class="va">True</span>)</span>
<span id="cb20-142"><a href="#cb20-142" aria-hidden="true" tabindex="-1"></a>annotate_points(axs[<span class="dv">0</span>], smoothed_data[<span class="st">'Total for Month'</span>], <span class="st">'blue'</span>)</span>
<span id="cb20-143"><a href="#cb20-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-144"><a href="#cb20-144" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].plot(smoothed_data.index, smoothed_data[<span class="st">'Exports for Month'</span>], marker<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">'orange'</span>)</span>
<span id="cb20-145"><a href="#cb20-145" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_title(<span class="st">"Exports for Month Adjusted for GDP Growth in Latin America"</span>)</span>
<span id="cb20-146"><a href="#cb20-146" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb20-147"><a href="#cb20-147" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_ylabel(<span class="st">'Exports Adjusted for GDP Growth'</span>)</span>
<span id="cb20-148"><a href="#cb20-148" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].grid(<span class="va">True</span>)</span>
<span id="cb20-149"><a href="#cb20-149" aria-hidden="true" tabindex="-1"></a>annotate_points(axs[<span class="dv">1</span>], smoothed_data[<span class="st">'Exports for Month'</span>], <span class="st">'orange'</span>)</span>
<span id="cb20-150"><a href="#cb20-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-151"><a href="#cb20-151" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].plot(smoothed_data.index, smoothed_data[<span class="st">'Imports for Month'</span>], marker<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb20-152"><a href="#cb20-152" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_title(<span class="st">"Imports for Month Adjusted for GDP Growth in Latin America"</span>)</span>
<span id="cb20-153"><a href="#cb20-153" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb20-154"><a href="#cb20-154" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_ylabel(<span class="st">'Imports Adjusted for GDP Growth'</span>)</span>
<span id="cb20-155"><a href="#cb20-155" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].grid(<span class="va">True</span>)</span>
<span id="cb20-156"><a href="#cb20-156" aria-hidden="true" tabindex="-1"></a>annotate_points(axs[<span class="dv">2</span>], smoothed_data[<span class="st">'Imports for Month'</span>], <span class="st">'green'</span>)</span>
<span id="cb20-157"><a href="#cb20-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-158"><a href="#cb20-158" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb20-159"><a href="#cb20-159" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>['TOTAL' 'Asia:' 'Afghanistan ' 'Bahrian ' 'Bangladesh' 'Bhutan' 'Brunei'
 'Myanmar ' 'Cambodia' 'Cyprus' 'Korea,DPR ' 'China Hong Kong' 'India'
 'Indonesia' 'Iran' 'Iraq' 'Israel' 'Japan' 'Jordan' 'Kuwait ' 'Lao PDR'
 'Lebanon' 'China Macau ' 'Malaysia' 'Maldives' 'Mongolia' 'Nepal,FDR'
 'Oman' 'Pakistan' 'Palestine' 'Philippines' 'Qatar' 'Saudi Arabia '
 'Singapore ' 'Korea,Rep.' 'Sri Lanka' 'Syrian Arab Republic' 'Thailand'
 'Turkey' 'United Arab Emirates' 'Yemen' 'Viet Nam' 'China' 'China Taiwan'
 'Timor-Leste ' 'Kazakhstan' 'Kyrgyzstan' 'Tajikistan' 'Turkmenistan'
 'Uzbekistan' 'Oth.Asia nes' 'Africa:' 'Algeria' 'Angola' 'Benin'
 'Botswana' 'Burundi' 'Cameroon' 'Canary Islands' 'Cape Verde '
 'Central African Rep.' 'Ceuta' 'Chad' 'Comoros' 'Congo' 'Djibouti'
 'Egypt ' 'Equatorial Guinea' 'Ethiopia ' 'Gabon' 'Gambia ' 'Ghana'
 'Guinea' 'Guinea-Bissau' "Cote d'Ivoire" 'Kenya' 'Liberia'
 'Libyan Arab Jamahiriya' 'Madagascar' 'Malawi' 'Mali ' 'Mauritania'
 'Mauritius' 'Morocco' 'Mozambique' 'Namibia' 'Niger' 'Nigeria ' 'Reunion'
 'Rwanda' 'Sao Tome and Principe' 'Senegal' 'Seychelles' 'Sierra Leone'
 'Somalia ' 'South Africa' 'Western Sahara ' 'Sudan' 'Tanzania' 'Togo '
 'Tunisia' 'Uganda' 'Burkina Faso' 'Congo,DR ' 'Zambia' 'Zimbabwe'
 'Lesotho' 'Melilla' 'Swaziland' 'Eritrea' 'Mayotte'
 'Republic of South Sudan' 'Oth.Afr.nes' 'Europe:' 'Belgium' 'Denmark'
 'United Kingdom' 'Germany' 'France ' 'Ireland' 'Italy' 'Luxembourg '
 'Netherlands' 'Greece' 'Portugal' 'Spain ' 'Albania' 'Andorra' 'Austria '
 'Bulgaria ' 'Finland' 'Gibraltar  ' 'Hungary ' 'Iceland' 'Liechtenstein '
 'Malta' 'Monaco' 'Norway' 'Poland' 'Romania ' 'San Marino' 'Sweden '
 'Switzerland' 'Estonia' 'Latvia ' 'Lithuania' 'Georgia ' 'Armenia '
 'Azerbaijan ' 'Belarus' 'Moldova' 'Russian Federation ' 'Ukraine'
 'Slovenia ' 'Croatia' 'Czech Republic' 'Slovakia'
 'Republic of North Macedonia' 'Bosnia and Hercegovina'
 'Vatican City State' 'Faroe Islands ' 'Serbia' 'Montenegro' 'Oth.Eur.nes'
 'Latin America:  ' 'Antigua and Barbuda' 'Argentina' 'Aruba' 'Bahamas'
 'Barbados' 'Belize' 'Bolivia' 'Bonaire' 'Brazil' 'Cayman Islands '
 'Chile ' 'Colombia ' 'Dominica' 'Costa Rica ' 'Cuba ' 'Curacao'
 'Dominican Republic' 'Ecuador' 'French Guiana' 'Grenada' 'Guadeloupe'
 'Guatemala ' 'Guyana' 'Haiti' 'Honduras' 'Jamaica' 'Martinique' 'Mexico'
 'Montserrat' 'Nicaragua' 'Panama ' 'Paraguay' 'Peru' 'Puerto Rico '
 'Saba' 'Saint Lucia' 'Saint Martin Islands' 'St.Vincent&amp;Grenadines'
 'El Salvador' 'Suriname' 'Trinidad and Tobago ' 'Turks&amp;Caicos Islands'
 'Uruguay' 'Venezuela ' 'Virgin Islands,British' 'St.Kitts&amp;Nevis'
 'St.Pierre&amp;Miquelon' 'Netherlands Antilles' 'Oth.L.Amer.nes '
 'North America: ' 'Canada ' 'United States' 'Greenland' 'Bermuda '
 'Oth.N.Amer.nes' 'Oceania: ' 'Australia ' 'Cook Islands' 'Fiji'
 'Gambier Islands' 'Marquesas Islands ' 'Nauru ' 'New Caledonia' 'Vanuatu'
 'New Zealand' 'Norfolk Island' 'Papua New Guinea ' 'Society Islands'
 'Solomon Islands ' 'Tonga' 'Tuamotu Islands ' 'Tubai Islands' 'Samoa'
 'Kiribati' 'Tuvalu ' 'Micronesia,FS' 'Marshall Islands ' 'Palau '
 'French Polynesia' 'Wallis and Futuna' 'Oth.Ocean.nes'
 'Countries(reg.)unknown ' 'ASEAN' 'EU ' 'APEC' 'Hong Kong，China'
 'Macao，China' 'Taiwan，China' 'Bahrain'
 "Democratic People's Republic of Korea" 'Hong Kong, China' 'Lao'
 'Macao, China' 'Nepal' 'Republic of Korea' 'Syria' 'Türkiye' 'Georgia'
 'Armenia' 'Azerbaijan' 'Other Asian Territories' 'Cabo Verde'
 'Central African Republic' 'Libya' 'Réunion'
 'Democratic Republic of Congo' 'Eswatini（Swaziland）' 'South Sudan'
 'French Southern Territories' 'British Indian Ocean Territory'
 'Saint Helena' 'Other African Territories' 'Russia'
 'Czechia（Czech Republic）' 'North Macedonia' 'Bosnia and Herzegovina'
 'Holy See' 'Åland Islands' 'Guernsey' 'Isle of Man' 'Jersey'
 'Svalbard and Jan Mayen Islands' 'Other European Territories' 'Curaçao'
 'Saint Martin (French Part)' 'Saint Vincent and the Grenadines'
 'Turks and Caicos Islands' 'British Virgin Islands'
 'Saint Kitts and Nevis' 'Bonaire, Sint Eustatius and Saba'
 'Saint Barthélemy' 'Bouvet Island' 'Falkland Islands (Malvinas)'
 'South Georgia and the South Sandwich Islands'
 'Sint Maarten (Dutch part)' 'United States Virgin Islands' 'Anguilla'
 'Other Latin American Territories' 'Saint Pierre and Miquelon'
 'Other North American Territories' 'The Federated States of Micronesia'
 'American Samoa' 'Cocos (Keeling) Islands' 'Christmas Island' 'Guam'
 'Heard Island and McDonald Islands' 'Northern Mariana Islands' 'Niue'
 'Pitcairn' 'Tokelau' 'United States Minor Outlying Islands'
 'Other Oceanian Territories' 'Antarctica' 'Countries（Territories）Unknown']
Index(['Source', 'Month', 'Month_num', 'Year', 'Country/region',
       'Total for Month', 'Total YTD', 'Exports for Month', 'Exports YTD',
       'Imports for Month', 'Imports YTD', 'Percentage Change YoY',
       'Exports YoY change', 'Imports YoY change'],
      dtype='object')
423     22,953,806
679     22,745,861
934     21,983,424
1190    25,923,433
1446    29,083,037
Name: Total for Month, dtype: object
423     11,051,457
679     10,794,716
934     11,017,830
1190    11,791,295
1446    14,228,121
Name: Exports for Month, dtype: object
423     11,902,349
679     11,951,145
934     10,965,594
1190    14,132,138
1446    14,854,916
Name: Imports for Month, dtype: object
Total for Month: Mean = 36513526.48, Median = 38016687.50, Std Dev = 7018049.37
Exports for Month: Mean = 18544222.40, Median = 19085241.00, Std Dev = 4154458.90
Imports for Month: Mean = 17969304.14, Median = 18447616.00, Std Dev = 3156168.26</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-11-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-11-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-11-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:        Total for Month   R-squared:                       0.636
Model:                            OLS   Adj. R-squared:                  0.630
Method:                 Least Squares   F-statistic:                     98.01
Date:                Sun, 08 Dec 2024   Prob (F-statistic):           6.58e-14
Time:                        22:21:55   Log-Likelihood:                -966.77
No. Observations:                  58   AIC:                             1938.
Df Residuals:                      56   BIC:                             1942.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const      -8.046e+09   8.16e+08     -9.855      0.000   -9.68e+09   -6.41e+09
Year        3.999e+06   4.04e+05      9.900      0.000    3.19e+06    4.81e+06
==============================================================================
Omnibus:                        1.085   Durbin-Watson:                   1.106
Prob(Omnibus):                  0.581   Jarque-Bera (JB):                1.042
Skew:                           0.309   Prob(JB):                        0.594
Kurtosis:                       2.778   Cond. No.                     2.94e+06
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 2.94e+06. This might indicate that there are
strong multicollinearity or other numerical problems.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\jonca\AppData\Local\Temp\ipykernel_3880\2229817788.py:118: FutureWarning: 'Y' is deprecated and will be removed in a future version, please use 'YE' instead.
  annual_median = latin_america_df[numeric_columns].resample('Y').median()</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-11-output-7.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="4357f08c-472c-41e2-be8e-aa7ea3b342ad" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statistics</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Verify unique values (optional, for debugging)</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">'Country/region'</span>].unique())</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Filter the DataFrame for Asia</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>asia_df <span class="op">=</span> df[</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'Country/region'</span>].<span class="bu">str</span>.contains(<span class="st">'Asia:'</span>, case<span class="op">=</span><span class="va">False</span>, na<span class="op">=</span><span class="va">False</span>) <span class="op">&amp;</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'Year'</span>].between(<span class="dv">2019</span>, <span class="dv">2024</span>)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>].copy()</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Convert 'Year' to numeric</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>asia_df[<span class="st">'Year'</span>] <span class="op">=</span> pd.to_numeric(asia_df[<span class="st">'Year'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Sort by 'Year'</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>asia_df <span class="op">=</span> asia_df.sort_values(by<span class="op">=</span><span class="st">'Year'</span>)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Drop rows with NaN in 'Total for Month'</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>asia_df <span class="op">=</span> asia_df.dropna(subset<span class="op">=</span>[<span class="st">'Total for Month'</span>])</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Inspect column names and values (optional, for debugging)</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(asia_df.columns)</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(asia_df[<span class="st">'Total for Month'</span>].head())</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 7: Clean and convert 'Total for Month' to numeric</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>asia_df[<span class="st">'Total for Month'</span>] <span class="op">=</span> (</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>    asia_df[<span class="st">'Total for Month'</span>]</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>    .astype(<span class="bu">str</span>)</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>.strip()</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>asia_df[<span class="st">'Total for Month'</span>] <span class="op">=</span> pd.to_numeric(asia_df[<span class="st">'Total for Month'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>asia_df <span class="op">=</span> asia_df.dropna(subset<span class="op">=</span>[<span class="st">'Total for Month'</span>])</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeat similar cleaning for 'Exports for Month' and 'Imports for Month'</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> [<span class="st">'Exports for Month'</span>, <span class="st">'Imports for Month'</span>]:</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(asia_df[column].head())  <span class="co"># Inspect the column values</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>    asia_df[column] <span class="op">=</span> (</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>        asia_df[column]</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>        .astype(<span class="bu">str</span>)</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">str</span>.strip()</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>    asia_df[column] <span class="op">=</span> pd.to_numeric(asia_df[column], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>    asia_df <span class="op">=</span> asia_df.dropna(subset<span class="op">=</span>[column])</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate statistics</span></span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Total for Month: Mean = </span><span class="sc">{:.2f}</span><span class="st">, Median = </span><span class="sc">{:.2f}</span><span class="st">, Std Dev = </span><span class="sc">{:.2f}</span><span class="st">"</span>.<span class="bu">format</span>(</span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>    statistics.mean(asia_df[<span class="st">'Total for Month'</span>]),</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>    statistics.median(asia_df[<span class="st">'Total for Month'</span>]),</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>    statistics.stdev(asia_df[<span class="st">'Total for Month'</span>])</span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Exports for Month: Mean = </span><span class="sc">{:.2f}</span><span class="st">, Median = </span><span class="sc">{:.2f}</span><span class="st">, Std Dev = </span><span class="sc">{:.2f}</span><span class="st">"</span>.<span class="bu">format</span>(</span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>    statistics.mean(asia_df[<span class="st">'Exports for Month'</span>]),</span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>    statistics.median(asia_df[<span class="st">'Exports for Month'</span>]),</span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>    statistics.stdev(asia_df[<span class="st">'Exports for Month'</span>])</span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Imports for Month: Mean = </span><span class="sc">{:.2f}</span><span class="st">, Median = </span><span class="sc">{:.2f}</span><span class="st">, Std Dev = </span><span class="sc">{:.2f}</span><span class="st">"</span>.<span class="bu">format</span>(</span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>    statistics.mean(asia_df[<span class="st">'Imports for Month'</span>]),</span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>    statistics.median(asia_df[<span class="st">'Imports for Month'</span>]),</span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>    statistics.stdev(asia_df[<span class="st">'Imports for Month'</span>])</span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 'Year_Month' for plotting</span></span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a>asia_df[<span class="st">'Year_Month'</span>] <span class="op">=</span> asia_df[<span class="st">'Year'</span>].astype(<span class="bu">str</span>) <span class="op">+</span> <span class="st">'_'</span> <span class="op">+</span> asia_df[<span class="st">'Month_num'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f"</span><span class="sc">{</span>x<span class="sc">:02}</span><span class="ss">"</span>)</span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a>X_numeric <span class="op">=</span> np.arange(<span class="bu">len</span>(asia_df))</span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> asia_df[<span class="st">'Year_Month'</span>]</span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot with regression line</span></span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_with_regression(y_var, y_label, title):</span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> asia_df[y_var]</span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a>    slope, intercept <span class="op">=</span> np.polyfit(X_numeric, Y, <span class="dv">1</span>)</span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a>    regression_line <span class="op">=</span> slope <span class="op">*</span> X_numeric <span class="op">+</span> intercept</span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a>    plt.plot(X, Y, marker<span class="op">=</span><span class="st">'o'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, label<span class="op">=</span>y_label)</span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a>    plt.plot(X, regression_line, linestyle<span class="op">=</span><span class="st">'--'</span>, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'Regression Line'</span>)</span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Year_Month'</span>)</span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(y_label)</span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a>    plt.title(title)</span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a>    tick_positions <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="bu">len</span>(X), <span class="bu">max</span>(<span class="dv">1</span>, <span class="bu">len</span>(X)<span class="op">//</span><span class="dv">10</span>))  <span class="co"># Adjust tick frequency</span></span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a>    tick_labels <span class="op">=</span> X.iloc[tick_positions]</span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a>    plt.xticks(ticks<span class="op">=</span>tick_positions, labels<span class="op">=</span>tick_labels, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a>    plt.grid(<span class="va">True</span>)</span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb24-95"><a href="#cb24-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-96"><a href="#cb24-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot each variable with its regression line</span></span>
<span id="cb24-97"><a href="#cb24-97" aria-hidden="true" tabindex="-1"></a>plot_with_regression(<span class="st">'Total for Month'</span>, <span class="st">'Total for Month'</span>, <span class="st">'Year vs Total for Month in Asia'</span>)</span>
<span id="cb24-98"><a href="#cb24-98" aria-hidden="true" tabindex="-1"></a>plot_with_regression(<span class="st">'Exports for Month'</span>, <span class="st">'Exports for Month'</span>, <span class="st">'Year vs Exports for Month in Asia'</span>)</span>
<span id="cb24-99"><a href="#cb24-99" aria-hidden="true" tabindex="-1"></a>plot_with_regression(<span class="st">'Imports for Month'</span>, <span class="st">'Imports for Month'</span>, <span class="st">'Year vs Imports for Month in Asia'</span>)</span>
<span id="cb24-100"><a href="#cb24-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-101"><a href="#cb24-101" aria-hidden="true" tabindex="-1"></a><span class="co"># OLS Regression</span></span>
<span id="cb24-102"><a href="#cb24-102" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> asia_df[[<span class="st">'Year'</span>]]</span>
<span id="cb24-103"><a href="#cb24-103" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> asia_df[<span class="st">'Total for Month'</span>]</span>
<span id="cb24-104"><a href="#cb24-104" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(X)</span>
<span id="cb24-105"><a href="#cb24-105" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> sm.OLS(Y, X).fit()</span>
<span id="cb24-106"><a href="#cb24-106" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model.summary())</span>
<span id="cb24-107"><a href="#cb24-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-108"><a href="#cb24-108" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'Year_Month' to datetime and set as index</span></span>
<span id="cb24-109"><a href="#cb24-109" aria-hidden="true" tabindex="-1"></a>asia_df[<span class="st">'Date'</span>] <span class="op">=</span> pd.to_datetime(asia_df[<span class="st">'Year_Month'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">'%Y_%m'</span>)</span>
<span id="cb24-110"><a href="#cb24-110" aria-hidden="true" tabindex="-1"></a>asia_df.set_index(<span class="st">'Date'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-111"><a href="#cb24-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-112"><a href="#cb24-112" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure columns for aggregation are numeric</span></span>
<span id="cb24-113"><a href="#cb24-113" aria-hidden="true" tabindex="-1"></a>numeric_columns <span class="op">=</span> [<span class="st">'Total for Month'</span>, <span class="st">'Exports for Month'</span>, <span class="st">'Imports for Month'</span>]</span>
<span id="cb24-114"><a href="#cb24-114" aria-hidden="true" tabindex="-1"></a>asia_df[numeric_columns] <span class="op">=</span> asia_df[numeric_columns].<span class="bu">apply</span>(pd.to_numeric, errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb24-115"><a href="#cb24-115" aria-hidden="true" tabindex="-1"></a>asia_df.dropna(subset<span class="op">=</span>numeric_columns, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-116"><a href="#cb24-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-117"><a href="#cb24-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Resample and compute median only for the selected numeric columns</span></span>
<span id="cb24-118"><a href="#cb24-118" aria-hidden="true" tabindex="-1"></a>annual_median <span class="op">=</span> asia_df[numeric_columns].resample(<span class="st">'Y'</span>).median()</span>
<span id="cb24-119"><a href="#cb24-119" aria-hidden="true" tabindex="-1"></a>annual_median.index <span class="op">=</span> annual_median.index.year</span>
<span id="cb24-120"><a href="#cb24-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-121"><a href="#cb24-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Global GDP growth data for adjustment</span></span>
<span id="cb24-122"><a href="#cb24-122" aria-hidden="true" tabindex="-1"></a>gdp_growth <span class="op">=</span> {<span class="dv">2019</span>: <span class="fl">2.64</span>, <span class="dv">2020</span>: <span class="op">-</span><span class="fl">2.93</span>, <span class="dv">2021</span>: <span class="fl">6.26</span>, <span class="dv">2022</span>: <span class="fl">3.09</span>, <span class="dv">2023</span>: <span class="fl">2.72</span>}</span>
<span id="cb24-123"><a href="#cb24-123" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> annual_median.index:</span>
<span id="cb24-124"><a href="#cb24-124" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> year <span class="kw">in</span> gdp_growth <span class="kw">and</span> gdp_growth[year] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb24-125"><a href="#cb24-125" aria-hidden="true" tabindex="-1"></a>        annual_median.loc[year] <span class="op">/=</span> gdp_growth[year]</span>
<span id="cb24-126"><a href="#cb24-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-127"><a href="#cb24-127" aria-hidden="true" tabindex="-1"></a>smoothed_data <span class="op">=</span> annual_median.rolling(window<span class="op">=</span><span class="dv">2</span>, min_periods<span class="op">=</span><span class="dv">1</span>).mean()</span>
<span id="cb24-128"><a href="#cb24-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-129"><a href="#cb24-129" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb24-130"><a href="#cb24-130" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">15</span>))</span>
<span id="cb24-131"><a href="#cb24-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-132"><a href="#cb24-132" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> annotate_points(ax, data, color):</span>
<span id="cb24-133"><a href="#cb24-133" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, (year, value) <span class="kw">in</span> <span class="bu">enumerate</span>(data.items()):</span>
<span id="cb24-134"><a href="#cb24-134" aria-hidden="true" tabindex="-1"></a>        ax.annotate(<span class="ss">f'</span><span class="sc">{</span>value<span class="sc">:.2f}</span><span class="ss">'</span>, (year, value), textcoords<span class="op">=</span><span class="st">"offset points"</span>,</span>
<span id="cb24-135"><a href="#cb24-135" aria-hidden="true" tabindex="-1"></a>                    xytext<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>), ha<span class="op">=</span><span class="st">'center'</span>, color<span class="op">=</span>color)</span>
<span id="cb24-136"><a href="#cb24-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-137"><a href="#cb24-137" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].plot(smoothed_data.index, smoothed_data[<span class="st">'Total for Month'</span>], marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb24-138"><a href="#cb24-138" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_title(<span class="st">"Total for Month Adjusted for GDP Growth in Asia"</span>)</span>
<span id="cb24-139"><a href="#cb24-139" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb24-140"><a href="#cb24-140" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_ylabel(<span class="st">'Trade Adjusted for GDP Growth'</span>)</span>
<span id="cb24-141"><a href="#cb24-141" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].grid(<span class="va">True</span>)</span>
<span id="cb24-142"><a href="#cb24-142" aria-hidden="true" tabindex="-1"></a>annotate_points(axs[<span class="dv">0</span>], smoothed_data[<span class="st">'Total for Month'</span>], <span class="st">'blue'</span>)</span>
<span id="cb24-143"><a href="#cb24-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-144"><a href="#cb24-144" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].plot(smoothed_data.index, smoothed_data[<span class="st">'Exports for Month'</span>], marker<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">'orange'</span>)</span>
<span id="cb24-145"><a href="#cb24-145" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_title(<span class="st">"Exports for Month Adjusted for GDP Growth in Asia"</span>)</span>
<span id="cb24-146"><a href="#cb24-146" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb24-147"><a href="#cb24-147" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_ylabel(<span class="st">'Exports Adjusted for GDP Growth'</span>)</span>
<span id="cb24-148"><a href="#cb24-148" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].grid(<span class="va">True</span>)</span>
<span id="cb24-149"><a href="#cb24-149" aria-hidden="true" tabindex="-1"></a>annotate_points(axs[<span class="dv">1</span>], smoothed_data[<span class="st">'Exports for Month'</span>], <span class="st">'orange'</span>)</span>
<span id="cb24-150"><a href="#cb24-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-151"><a href="#cb24-151" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].plot(smoothed_data.index, smoothed_data[<span class="st">'Imports for Month'</span>], marker<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb24-152"><a href="#cb24-152" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_title(<span class="st">"Imports for Month Adjusted for GDP Growth in Asia"</span>)</span>
<span id="cb24-153"><a href="#cb24-153" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb24-154"><a href="#cb24-154" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_ylabel(<span class="st">'Imports Adjusted for GDP Growth'</span>)</span>
<span id="cb24-155"><a href="#cb24-155" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].grid(<span class="va">True</span>)</span>
<span id="cb24-156"><a href="#cb24-156" aria-hidden="true" tabindex="-1"></a>annotate_points(axs[<span class="dv">2</span>], smoothed_data[<span class="st">'Imports for Month'</span>], <span class="st">'green'</span>)</span>
<span id="cb24-157"><a href="#cb24-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-158"><a href="#cb24-158" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb24-159"><a href="#cb24-159" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>['TOTAL' 'Asia:' 'Afghanistan ' 'Bahrian ' 'Bangladesh' 'Bhutan' 'Brunei'
 'Myanmar ' 'Cambodia' 'Cyprus' 'Korea,DPR ' 'China Hong Kong' 'India'
 'Indonesia' 'Iran' 'Iraq' 'Israel' 'Japan' 'Jordan' 'Kuwait ' 'Lao PDR'
 'Lebanon' 'China Macau ' 'Malaysia' 'Maldives' 'Mongolia' 'Nepal,FDR'
 'Oman' 'Pakistan' 'Palestine' 'Philippines' 'Qatar' 'Saudi Arabia '
 'Singapore ' 'Korea,Rep.' 'Sri Lanka' 'Syrian Arab Republic' 'Thailand'
 'Turkey' 'United Arab Emirates' 'Yemen' 'Viet Nam' 'China' 'China Taiwan'
 'Timor-Leste ' 'Kazakhstan' 'Kyrgyzstan' 'Tajikistan' 'Turkmenistan'
 'Uzbekistan' 'Oth.Asia nes' 'Africa:' 'Algeria' 'Angola' 'Benin'
 'Botswana' 'Burundi' 'Cameroon' 'Canary Islands' 'Cape Verde '
 'Central African Rep.' 'Ceuta' 'Chad' 'Comoros' 'Congo' 'Djibouti'
 'Egypt ' 'Equatorial Guinea' 'Ethiopia ' 'Gabon' 'Gambia ' 'Ghana'
 'Guinea' 'Guinea-Bissau' "Cote d'Ivoire" 'Kenya' 'Liberia'
 'Libyan Arab Jamahiriya' 'Madagascar' 'Malawi' 'Mali ' 'Mauritania'
 'Mauritius' 'Morocco' 'Mozambique' 'Namibia' 'Niger' 'Nigeria ' 'Reunion'
 'Rwanda' 'Sao Tome and Principe' 'Senegal' 'Seychelles' 'Sierra Leone'
 'Somalia ' 'South Africa' 'Western Sahara ' 'Sudan' 'Tanzania' 'Togo '
 'Tunisia' 'Uganda' 'Burkina Faso' 'Congo,DR ' 'Zambia' 'Zimbabwe'
 'Lesotho' 'Melilla' 'Swaziland' 'Eritrea' 'Mayotte'
 'Republic of South Sudan' 'Oth.Afr.nes' 'Europe:' 'Belgium' 'Denmark'
 'United Kingdom' 'Germany' 'France ' 'Ireland' 'Italy' 'Luxembourg '
 'Netherlands' 'Greece' 'Portugal' 'Spain ' 'Albania' 'Andorra' 'Austria '
 'Bulgaria ' 'Finland' 'Gibraltar  ' 'Hungary ' 'Iceland' 'Liechtenstein '
 'Malta' 'Monaco' 'Norway' 'Poland' 'Romania ' 'San Marino' 'Sweden '
 'Switzerland' 'Estonia' 'Latvia ' 'Lithuania' 'Georgia ' 'Armenia '
 'Azerbaijan ' 'Belarus' 'Moldova' 'Russian Federation ' 'Ukraine'
 'Slovenia ' 'Croatia' 'Czech Republic' 'Slovakia'
 'Republic of North Macedonia' 'Bosnia and Hercegovina'
 'Vatican City State' 'Faroe Islands ' 'Serbia' 'Montenegro' 'Oth.Eur.nes'
 'Latin America:  ' 'Antigua and Barbuda' 'Argentina' 'Aruba' 'Bahamas'
 'Barbados' 'Belize' 'Bolivia' 'Bonaire' 'Brazil' 'Cayman Islands '
 'Chile ' 'Colombia ' 'Dominica' 'Costa Rica ' 'Cuba ' 'Curacao'
 'Dominican Republic' 'Ecuador' 'French Guiana' 'Grenada' 'Guadeloupe'
 'Guatemala ' 'Guyana' 'Haiti' 'Honduras' 'Jamaica' 'Martinique' 'Mexico'
 'Montserrat' 'Nicaragua' 'Panama ' 'Paraguay' 'Peru' 'Puerto Rico '
 'Saba' 'Saint Lucia' 'Saint Martin Islands' 'St.Vincent&amp;Grenadines'
 'El Salvador' 'Suriname' 'Trinidad and Tobago ' 'Turks&amp;Caicos Islands'
 'Uruguay' 'Venezuela ' 'Virgin Islands,British' 'St.Kitts&amp;Nevis'
 'St.Pierre&amp;Miquelon' 'Netherlands Antilles' 'Oth.L.Amer.nes '
 'North America: ' 'Canada ' 'United States' 'Greenland' 'Bermuda '
 'Oth.N.Amer.nes' 'Oceania: ' 'Australia ' 'Cook Islands' 'Fiji'
 'Gambier Islands' 'Marquesas Islands ' 'Nauru ' 'New Caledonia' 'Vanuatu'
 'New Zealand' 'Norfolk Island' 'Papua New Guinea ' 'Society Islands'
 'Solomon Islands ' 'Tonga' 'Tuamotu Islands ' 'Tubai Islands' 'Samoa'
 'Kiribati' 'Tuvalu ' 'Micronesia,FS' 'Marshall Islands ' 'Palau '
 'French Polynesia' 'Wallis and Futuna' 'Oth.Ocean.nes'
 'Countries(reg.)unknown ' 'ASEAN' 'EU ' 'APEC' 'Hong Kong，China'
 'Macao，China' 'Taiwan，China' 'Bahrain'
 "Democratic People's Republic of Korea" 'Hong Kong, China' 'Lao'
 'Macao, China' 'Nepal' 'Republic of Korea' 'Syria' 'Türkiye' 'Georgia'
 'Armenia' 'Azerbaijan' 'Other Asian Territories' 'Cabo Verde'
 'Central African Republic' 'Libya' 'Réunion'
 'Democratic Republic of Congo' 'Eswatini（Swaziland）' 'South Sudan'
 'French Southern Territories' 'British Indian Ocean Territory'
 'Saint Helena' 'Other African Territories' 'Russia'
 'Czechia（Czech Republic）' 'North Macedonia' 'Bosnia and Herzegovina'
 'Holy See' 'Åland Islands' 'Guernsey' 'Isle of Man' 'Jersey'
 'Svalbard and Jan Mayen Islands' 'Other European Territories' 'Curaçao'
 'Saint Martin (French Part)' 'Saint Vincent and the Grenadines'
 'Turks and Caicos Islands' 'British Virgin Islands'
 'Saint Kitts and Nevis' 'Bonaire, Sint Eustatius and Saba'
 'Saint Barthélemy' 'Bouvet Island' 'Falkland Islands (Malvinas)'
 'South Georgia and the South Sandwich Islands'
 'Sint Maarten (Dutch part)' 'United States Virgin Islands' 'Anguilla'
 'Other Latin American Territories' 'Saint Pierre and Miquelon'
 'Other North American Territories' 'The Federated States of Micronesia'
 'American Samoa' 'Cocos (Keeling) Islands' 'Christmas Island' 'Guam'
 'Heard Island and McDonald Islands' 'Northern Mariana Islands' 'Niue'
 'Pitcairn' 'Tokelau' 'United States Minor Outlying Islands'
 'Other Oceanian Territories' 'Antarctica' 'Countries（Territories）Unknown']
Index(['Source', 'Month', 'Month_num', 'Year', 'Country/region',
       'Total for Month', 'Total YTD', 'Exports for Month', 'Exports YTD',
       'Imports for Month', 'Imports YTD', 'Percentage Change YoY',
       'Exports YoY change', 'Imports YoY change'],
      dtype='object')
260     195,095,889
516     186,135,935
771     177,681,329
1027    192,483,052
1283    201,518,346
Name: Total for Month, dtype: object
260     100,933,241
516      97,703,604
771      94,381,167
1027     96,903,476
1283    104,851,590
Name: Exports for Month, dtype: object
260     94,162,648
516     88,432,330
771     83,300,162
1027    95,579,576
1283    96,666,756
Name: Imports for Month, dtype: object
Total for Month: Mean = 242558536.41, Median = 249903765.00, Std Dev = 31907914.18
Exports for Month: Mean = 129483794.57, Median = 132104075.50, Std Dev = 19705591.37
Imports for Month: Mean = 113074721.26, Median = 114364931.00, Std Dev = 13962740.84</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-12-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-12-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-12-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:        Total for Month   R-squared:                       0.290
Model:                            OLS   Adj. R-squared:                  0.277
Method:                 Least Squares   F-statistic:                     22.85
Date:                Sun, 08 Dec 2024   Prob (F-statistic):           1.31e-05
Time:                        22:21:56   Log-Likelihood:                -1074.0
No. Observations:                  58   AIC:                             2152.
Df Residuals:                      56   BIC:                             2156.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const      -2.455e+10   5.19e+09     -4.734      0.000   -3.49e+10   -1.42e+10
Year        1.227e+07   2.57e+06      4.780      0.000    7.13e+06    1.74e+07
==============================================================================
Omnibus:                        0.592   Durbin-Watson:                   1.123
Prob(Omnibus):                  0.744   Jarque-Bera (JB):                0.205
Skew:                          -0.127   Prob(JB):                        0.903
Kurtosis:                       3.143   Cond. No.                     2.94e+06
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 2.94e+06. This might indicate that there are
strong multicollinearity or other numerical problems.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\jonca\AppData\Local\Temp\ipykernel_3880\3892219508.py:118: FutureWarning: 'Y' is deprecated and will be removed in a future version, please use 'YE' instead.
  annual_median = asia_df[numeric_columns].resample('Y').median()</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-12-output-7.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="25573326-d16f-4c29-a02a-5d9c911e4419" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statistics</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Verify unique values in 'Country/region' (optional, for debugging)</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">'Country/region'</span>].unique())</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Filter the DataFrame for Oceania</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>oceania_df <span class="op">=</span> df[</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'Country/region'</span>].<span class="bu">str</span>.contains(<span class="st">'Oceania:'</span>, case<span class="op">=</span><span class="va">False</span>, na<span class="op">=</span><span class="va">False</span>) <span class="op">&amp;</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'Year'</span>].between(<span class="dv">2019</span>, <span class="dv">2024</span>)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>].copy()</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Convert 'Year' to numeric</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>oceania_df[<span class="st">'Year'</span>] <span class="op">=</span> pd.to_numeric(oceania_df[<span class="st">'Year'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Sort by 'Year'</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>oceania_df <span class="op">=</span> oceania_df.sort_values(by<span class="op">=</span><span class="st">'Year'</span>)</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Drop rows with NaN in 'Total for Month'</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>oceania_df <span class="op">=</span> oceania_df.dropna(subset<span class="op">=</span>[<span class="st">'Total for Month'</span>])</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Inspect column names and values (optional, for debugging)</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(oceania_df.columns)</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(oceania_df[<span class="st">'Total for Month'</span>].head())</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 7: Clean and convert 'Total for Month' to numeric</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>oceania_df[<span class="st">'Total for Month'</span>] <span class="op">=</span> (</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>    oceania_df[<span class="st">'Total for Month'</span>]</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>    .astype(<span class="bu">str</span>)</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>.strip()</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>oceania_df[<span class="st">'Total for Month'</span>] <span class="op">=</span> pd.to_numeric(oceania_df[<span class="st">'Total for Month'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>oceania_df <span class="op">=</span> oceania_df.dropna(subset<span class="op">=</span>[<span class="st">'Total for Month'</span>])</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeat similar cleaning for 'Exports for Month' and 'Imports for Month'</span></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> [<span class="st">'Exports for Month'</span>, <span class="st">'Imports for Month'</span>]:</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(oceania_df[column].head())  <span class="co"># Inspect the column values</span></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>    oceania_df[column] <span class="op">=</span> (</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>        oceania_df[column]</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>        .astype(<span class="bu">str</span>)</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">str</span>.strip()</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>    oceania_df[column] <span class="op">=</span> pd.to_numeric(oceania_df[column], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>    oceania_df <span class="op">=</span> oceania_df.dropna(subset<span class="op">=</span>[column])</span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate statistics</span></span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Total for Month: Mean = </span><span class="sc">{:.2f}</span><span class="st">, Median = </span><span class="sc">{:.2f}</span><span class="st">, Std Dev = </span><span class="sc">{:.2f}</span><span class="st">"</span>.<span class="bu">format</span>(</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>    statistics.mean(oceania_df[<span class="st">'Total for Month'</span>]),</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>    statistics.median(oceania_df[<span class="st">'Total for Month'</span>]),</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>    statistics.stdev(oceania_df[<span class="st">'Total for Month'</span>])</span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Exports for Month: Mean = </span><span class="sc">{:.2f}</span><span class="st">, Median = </span><span class="sc">{:.2f}</span><span class="st">, Std Dev = </span><span class="sc">{:.2f}</span><span class="st">"</span>.<span class="bu">format</span>(</span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>    statistics.mean(oceania_df[<span class="st">'Exports for Month'</span>]),</span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>    statistics.median(oceania_df[<span class="st">'Exports for Month'</span>]),</span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>    statistics.stdev(oceania_df[<span class="st">'Exports for Month'</span>])</span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Imports for Month: Mean = </span><span class="sc">{:.2f}</span><span class="st">, Median = </span><span class="sc">{:.2f}</span><span class="st">, Std Dev = </span><span class="sc">{:.2f}</span><span class="st">"</span>.<span class="bu">format</span>(</span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a>    statistics.mean(oceania_df[<span class="st">'Imports for Month'</span>]),</span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a>    statistics.median(oceania_df[<span class="st">'Imports for Month'</span>]),</span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a>    statistics.stdev(oceania_df[<span class="st">'Imports for Month'</span>])</span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 'Year_Month' for plotting</span></span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a>oceania_df[<span class="st">'Year_Month'</span>] <span class="op">=</span> oceania_df[<span class="st">'Year'</span>].astype(<span class="bu">str</span>) <span class="op">+</span> <span class="st">'_'</span> <span class="op">+</span> oceania_df[<span class="st">'Month_num'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f"</span><span class="sc">{</span>x<span class="sc">:02}</span><span class="ss">"</span>)</span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a>X_numeric <span class="op">=</span> np.arange(<span class="bu">len</span>(oceania_df))</span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> oceania_df[<span class="st">'Year_Month'</span>]</span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot with regression line</span></span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_with_regression(y_var, y_label, title):</span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> oceania_df[y_var]</span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a>    slope, intercept <span class="op">=</span> np.polyfit(X_numeric, Y, <span class="dv">1</span>)</span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a>    regression_line <span class="op">=</span> slope <span class="op">*</span> X_numeric <span class="op">+</span> intercept</span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a>    plt.plot(X, Y, marker<span class="op">=</span><span class="st">'o'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, label<span class="op">=</span>y_label)</span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a>    plt.plot(X, regression_line, linestyle<span class="op">=</span><span class="st">'--'</span>, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'Regression Line'</span>)</span>
<span id="cb28-83"><a href="#cb28-83" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Year_Month'</span>)</span>
<span id="cb28-84"><a href="#cb28-84" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(y_label)</span>
<span id="cb28-85"><a href="#cb28-85" aria-hidden="true" tabindex="-1"></a>    plt.title(title)</span>
<span id="cb28-86"><a href="#cb28-86" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-87"><a href="#cb28-87" aria-hidden="true" tabindex="-1"></a>    tick_positions <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="bu">len</span>(X), <span class="bu">max</span>(<span class="dv">1</span>, <span class="bu">len</span>(X)<span class="op">//</span><span class="dv">10</span>))  <span class="co"># Adjust tick frequency</span></span>
<span id="cb28-88"><a href="#cb28-88" aria-hidden="true" tabindex="-1"></a>    tick_labels <span class="op">=</span> X.iloc[tick_positions]</span>
<span id="cb28-89"><a href="#cb28-89" aria-hidden="true" tabindex="-1"></a>    plt.xticks(ticks<span class="op">=</span>tick_positions, labels<span class="op">=</span>tick_labels, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb28-90"><a href="#cb28-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-91"><a href="#cb28-91" aria-hidden="true" tabindex="-1"></a>    plt.grid(<span class="va">True</span>)</span>
<span id="cb28-92"><a href="#cb28-92" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb28-93"><a href="#cb28-93" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb28-94"><a href="#cb28-94" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb28-95"><a href="#cb28-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-96"><a href="#cb28-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot each variable with its regression line</span></span>
<span id="cb28-97"><a href="#cb28-97" aria-hidden="true" tabindex="-1"></a>plot_with_regression(<span class="st">'Total for Month'</span>, <span class="st">'Total for Month'</span>, <span class="st">'Year vs Total for Month in Oceania'</span>)</span>
<span id="cb28-98"><a href="#cb28-98" aria-hidden="true" tabindex="-1"></a>plot_with_regression(<span class="st">'Exports for Month'</span>, <span class="st">'Exports for Month'</span>, <span class="st">'Year vs Exports for Month in Oceania'</span>)</span>
<span id="cb28-99"><a href="#cb28-99" aria-hidden="true" tabindex="-1"></a>plot_with_regression(<span class="st">'Imports for Month'</span>, <span class="st">'Imports for Month'</span>, <span class="st">'Year vs Imports for Month in Oceania'</span>)</span>
<span id="cb28-100"><a href="#cb28-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-101"><a href="#cb28-101" aria-hidden="true" tabindex="-1"></a><span class="co"># OLS Regression</span></span>
<span id="cb28-102"><a href="#cb28-102" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> oceania_df[[<span class="st">'Year'</span>]]</span>
<span id="cb28-103"><a href="#cb28-103" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> oceania_df[<span class="st">'Total for Month'</span>]</span>
<span id="cb28-104"><a href="#cb28-104" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(X)</span>
<span id="cb28-105"><a href="#cb28-105" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> sm.OLS(Y, X).fit()</span>
<span id="cb28-106"><a href="#cb28-106" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model.summary())</span>
<span id="cb28-107"><a href="#cb28-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-108"><a href="#cb28-108" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'Year_Month' to datetime and set as index</span></span>
<span id="cb28-109"><a href="#cb28-109" aria-hidden="true" tabindex="-1"></a>oceania_df[<span class="st">'Date'</span>] <span class="op">=</span> pd.to_datetime(oceania_df[<span class="st">'Year_Month'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">'%Y_%m'</span>)</span>
<span id="cb28-110"><a href="#cb28-110" aria-hidden="true" tabindex="-1"></a>oceania_df.set_index(<span class="st">'Date'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-111"><a href="#cb28-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-112"><a href="#cb28-112" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure columns for aggregation are numeric</span></span>
<span id="cb28-113"><a href="#cb28-113" aria-hidden="true" tabindex="-1"></a>numeric_columns <span class="op">=</span> [<span class="st">'Total for Month'</span>, <span class="st">'Exports for Month'</span>, <span class="st">'Imports for Month'</span>]</span>
<span id="cb28-114"><a href="#cb28-114" aria-hidden="true" tabindex="-1"></a>oceania_df[numeric_columns] <span class="op">=</span> oceania_df[numeric_columns].<span class="bu">apply</span>(pd.to_numeric, errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb28-115"><a href="#cb28-115" aria-hidden="true" tabindex="-1"></a>oceania_df.dropna(subset<span class="op">=</span>numeric_columns, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-116"><a href="#cb28-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-117"><a href="#cb28-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Resample and compute median only for the selected numeric columns</span></span>
<span id="cb28-118"><a href="#cb28-118" aria-hidden="true" tabindex="-1"></a>annual_median <span class="op">=</span> oceania_df[numeric_columns].resample(<span class="st">'Y'</span>).median()</span>
<span id="cb28-119"><a href="#cb28-119" aria-hidden="true" tabindex="-1"></a>annual_median.index <span class="op">=</span> annual_median.index.year</span>
<span id="cb28-120"><a href="#cb28-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-121"><a href="#cb28-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Global GDP growth data for adjustment</span></span>
<span id="cb28-122"><a href="#cb28-122" aria-hidden="true" tabindex="-1"></a>gdp_growth <span class="op">=</span> {<span class="dv">2019</span>: <span class="fl">2.64</span>, <span class="dv">2020</span>: <span class="op">-</span><span class="fl">2.93</span>, <span class="dv">2021</span>: <span class="fl">6.26</span>, <span class="dv">2022</span>: <span class="fl">3.09</span>, <span class="dv">2023</span>: <span class="fl">2.72</span>}</span>
<span id="cb28-123"><a href="#cb28-123" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> annual_median.index:</span>
<span id="cb28-124"><a href="#cb28-124" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> year <span class="kw">in</span> gdp_growth <span class="kw">and</span> gdp_growth[year] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb28-125"><a href="#cb28-125" aria-hidden="true" tabindex="-1"></a>        annual_median.loc[year] <span class="op">/=</span> gdp_growth[year]</span>
<span id="cb28-126"><a href="#cb28-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-127"><a href="#cb28-127" aria-hidden="true" tabindex="-1"></a>smoothed_data <span class="op">=</span> annual_median.rolling(window<span class="op">=</span><span class="dv">2</span>, min_periods<span class="op">=</span><span class="dv">1</span>).mean()</span>
<span id="cb28-128"><a href="#cb28-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-129"><a href="#cb28-129" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb28-130"><a href="#cb28-130" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">15</span>))</span>
<span id="cb28-131"><a href="#cb28-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-132"><a href="#cb28-132" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> annotate_points(ax, data, color):</span>
<span id="cb28-133"><a href="#cb28-133" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, (year, value) <span class="kw">in</span> <span class="bu">enumerate</span>(data.items()):</span>
<span id="cb28-134"><a href="#cb28-134" aria-hidden="true" tabindex="-1"></a>        ax.annotate(<span class="ss">f'</span><span class="sc">{</span>value<span class="sc">:.2f}</span><span class="ss">'</span>, (year, value), textcoords<span class="op">=</span><span class="st">"offset points"</span>,</span>
<span id="cb28-135"><a href="#cb28-135" aria-hidden="true" tabindex="-1"></a>                    xytext<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>), ha<span class="op">=</span><span class="st">'center'</span>, color<span class="op">=</span>color)</span>
<span id="cb28-136"><a href="#cb28-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-137"><a href="#cb28-137" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].plot(smoothed_data.index, smoothed_data[<span class="st">'Total for Month'</span>], marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb28-138"><a href="#cb28-138" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_title(<span class="st">"Total for Month Adjusted for GDP Growth in Oceania"</span>)</span>
<span id="cb28-139"><a href="#cb28-139" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb28-140"><a href="#cb28-140" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_ylabel(<span class="st">'Trade Adjusted for GDP Growth'</span>)</span>
<span id="cb28-141"><a href="#cb28-141" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].grid(<span class="va">True</span>)</span>
<span id="cb28-142"><a href="#cb28-142" aria-hidden="true" tabindex="-1"></a>annotate_points(axs[<span class="dv">0</span>], smoothed_data[<span class="st">'Total for Month'</span>], <span class="st">'blue'</span>)</span>
<span id="cb28-143"><a href="#cb28-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-144"><a href="#cb28-144" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].plot(smoothed_data.index, smoothed_data[<span class="st">'Exports for Month'</span>], marker<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">'orange'</span>)</span>
<span id="cb28-145"><a href="#cb28-145" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_title(<span class="st">"Exports for Month Adjusted for GDP Growth in Oceania"</span>)</span>
<span id="cb28-146"><a href="#cb28-146" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb28-147"><a href="#cb28-147" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_ylabel(<span class="st">'Exports Adjusted for GDP Growth'</span>)</span>
<span id="cb28-148"><a href="#cb28-148" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].grid(<span class="va">True</span>)</span>
<span id="cb28-149"><a href="#cb28-149" aria-hidden="true" tabindex="-1"></a>annotate_points(axs[<span class="dv">1</span>], smoothed_data[<span class="st">'Exports for Month'</span>], <span class="st">'orange'</span>)</span>
<span id="cb28-150"><a href="#cb28-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-151"><a href="#cb28-151" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].plot(smoothed_data.index, smoothed_data[<span class="st">'Imports for Month'</span>], marker<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb28-152"><a href="#cb28-152" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_title(<span class="st">"Imports for Month Adjusted for GDP Growth in Oceania"</span>)</span>
<span id="cb28-153"><a href="#cb28-153" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb28-154"><a href="#cb28-154" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_ylabel(<span class="st">'Imports Adjusted for GDP Growth'</span>)</span>
<span id="cb28-155"><a href="#cb28-155" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].grid(<span class="va">True</span>)</span>
<span id="cb28-156"><a href="#cb28-156" aria-hidden="true" tabindex="-1"></a>annotate_points(axs[<span class="dv">2</span>], smoothed_data[<span class="st">'Imports for Month'</span>], <span class="st">'green'</span>)</span>
<span id="cb28-157"><a href="#cb28-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-158"><a href="#cb28-158" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb28-159"><a href="#cb28-159" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>['TOTAL' 'Asia:' 'Afghanistan ' 'Bahrian ' 'Bangladesh' 'Bhutan' 'Brunei'
 'Myanmar ' 'Cambodia' 'Cyprus' 'Korea,DPR ' 'China Hong Kong' 'India'
 'Indonesia' 'Iran' 'Iraq' 'Israel' 'Japan' 'Jordan' 'Kuwait ' 'Lao PDR'
 'Lebanon' 'China Macau ' 'Malaysia' 'Maldives' 'Mongolia' 'Nepal,FDR'
 'Oman' 'Pakistan' 'Palestine' 'Philippines' 'Qatar' 'Saudi Arabia '
 'Singapore ' 'Korea,Rep.' 'Sri Lanka' 'Syrian Arab Republic' 'Thailand'
 'Turkey' 'United Arab Emirates' 'Yemen' 'Viet Nam' 'China' 'China Taiwan'
 'Timor-Leste ' 'Kazakhstan' 'Kyrgyzstan' 'Tajikistan' 'Turkmenistan'
 'Uzbekistan' 'Oth.Asia nes' 'Africa:' 'Algeria' 'Angola' 'Benin'
 'Botswana' 'Burundi' 'Cameroon' 'Canary Islands' 'Cape Verde '
 'Central African Rep.' 'Ceuta' 'Chad' 'Comoros' 'Congo' 'Djibouti'
 'Egypt ' 'Equatorial Guinea' 'Ethiopia ' 'Gabon' 'Gambia ' 'Ghana'
 'Guinea' 'Guinea-Bissau' "Cote d'Ivoire" 'Kenya' 'Liberia'
 'Libyan Arab Jamahiriya' 'Madagascar' 'Malawi' 'Mali ' 'Mauritania'
 'Mauritius' 'Morocco' 'Mozambique' 'Namibia' 'Niger' 'Nigeria ' 'Reunion'
 'Rwanda' 'Sao Tome and Principe' 'Senegal' 'Seychelles' 'Sierra Leone'
 'Somalia ' 'South Africa' 'Western Sahara ' 'Sudan' 'Tanzania' 'Togo '
 'Tunisia' 'Uganda' 'Burkina Faso' 'Congo,DR ' 'Zambia' 'Zimbabwe'
 'Lesotho' 'Melilla' 'Swaziland' 'Eritrea' 'Mayotte'
 'Republic of South Sudan' 'Oth.Afr.nes' 'Europe:' 'Belgium' 'Denmark'
 'United Kingdom' 'Germany' 'France ' 'Ireland' 'Italy' 'Luxembourg '
 'Netherlands' 'Greece' 'Portugal' 'Spain ' 'Albania' 'Andorra' 'Austria '
 'Bulgaria ' 'Finland' 'Gibraltar  ' 'Hungary ' 'Iceland' 'Liechtenstein '
 'Malta' 'Monaco' 'Norway' 'Poland' 'Romania ' 'San Marino' 'Sweden '
 'Switzerland' 'Estonia' 'Latvia ' 'Lithuania' 'Georgia ' 'Armenia '
 'Azerbaijan ' 'Belarus' 'Moldova' 'Russian Federation ' 'Ukraine'
 'Slovenia ' 'Croatia' 'Czech Republic' 'Slovakia'
 'Republic of North Macedonia' 'Bosnia and Hercegovina'
 'Vatican City State' 'Faroe Islands ' 'Serbia' 'Montenegro' 'Oth.Eur.nes'
 'Latin America:  ' 'Antigua and Barbuda' 'Argentina' 'Aruba' 'Bahamas'
 'Barbados' 'Belize' 'Bolivia' 'Bonaire' 'Brazil' 'Cayman Islands '
 'Chile ' 'Colombia ' 'Dominica' 'Costa Rica ' 'Cuba ' 'Curacao'
 'Dominican Republic' 'Ecuador' 'French Guiana' 'Grenada' 'Guadeloupe'
 'Guatemala ' 'Guyana' 'Haiti' 'Honduras' 'Jamaica' 'Martinique' 'Mexico'
 'Montserrat' 'Nicaragua' 'Panama ' 'Paraguay' 'Peru' 'Puerto Rico '
 'Saba' 'Saint Lucia' 'Saint Martin Islands' 'St.Vincent&amp;Grenadines'
 'El Salvador' 'Suriname' 'Trinidad and Tobago ' 'Turks&amp;Caicos Islands'
 'Uruguay' 'Venezuela ' 'Virgin Islands,British' 'St.Kitts&amp;Nevis'
 'St.Pierre&amp;Miquelon' 'Netherlands Antilles' 'Oth.L.Amer.nes '
 'North America: ' 'Canada ' 'United States' 'Greenland' 'Bermuda '
 'Oth.N.Amer.nes' 'Oceania: ' 'Australia ' 'Cook Islands' 'Fiji'
 'Gambier Islands' 'Marquesas Islands ' 'Nauru ' 'New Caledonia' 'Vanuatu'
 'New Zealand' 'Norfolk Island' 'Papua New Guinea ' 'Society Islands'
 'Solomon Islands ' 'Tonga' 'Tuamotu Islands ' 'Tubai Islands' 'Samoa'
 'Kiribati' 'Tuvalu ' 'Micronesia,FS' 'Marshall Islands ' 'Palau '
 'French Polynesia' 'Wallis and Futuna' 'Oth.Ocean.nes'
 'Countries(reg.)unknown ' 'ASEAN' 'EU ' 'APEC' 'Hong Kong，China'
 'Macao，China' 'Taiwan，China' 'Bahrain'
 "Democratic People's Republic of Korea" 'Hong Kong, China' 'Lao'
 'Macao, China' 'Nepal' 'Republic of Korea' 'Syria' 'Türkiye' 'Georgia'
 'Armenia' 'Azerbaijan' 'Other Asian Territories' 'Cabo Verde'
 'Central African Republic' 'Libya' 'Réunion'
 'Democratic Republic of Congo' 'Eswatini（Swaziland）' 'South Sudan'
 'French Southern Territories' 'British Indian Ocean Territory'
 'Saint Helena' 'Other African Territories' 'Russia'
 'Czechia（Czech Republic）' 'North Macedonia' 'Bosnia and Herzegovina'
 'Holy See' 'Åland Islands' 'Guernsey' 'Isle of Man' 'Jersey'
 'Svalbard and Jan Mayen Islands' 'Other European Territories' 'Curaçao'
 'Saint Martin (French Part)' 'Saint Vincent and the Grenadines'
 'Turks and Caicos Islands' 'British Virgin Islands'
 'Saint Kitts and Nevis' 'Bonaire, Sint Eustatius and Saba'
 'Saint Barthélemy' 'Bouvet Island' 'Falkland Islands (Malvinas)'
 'South Georgia and the South Sandwich Islands'
 'Sint Maarten (Dutch part)' 'United States Virgin Islands' 'Anguilla'
 'Other Latin American Territories' 'Saint Pierre and Miquelon'
 'Other North American Territories' 'The Federated States of Micronesia'
 'American Samoa' 'Cocos (Keeling) Islands' 'Christmas Island' 'Guam'
 'Heard Island and McDonald Islands' 'Northern Mariana Islands' 'Niue'
 'Pitcairn' 'Tokelau' 'United States Minor Outlying Islands'
 'Other Oceanian Territories' 'Antarctica' 'Countries（Territories）Unknown']
Index(['Source', 'Month', 'Month_num', 'Year', 'Country/region',
       'Total for Month', 'Total YTD', 'Exports for Month', 'Exports YTD',
       'Imports for Month', 'Imports YTD', 'Percentage Change YoY',
       'Exports YoY change', 'Imports YoY change'],
      dtype='object')
479     14,875,551
735     16,717,462
990     15,676,312
1246    15,950,817
1502    18,000,642
Name: Total for Month, dtype: object
479     4,626,585
735     5,284,660
990     5,725,773
1246    5,115,285
1502    4,935,819
Name: Exports for Month, dtype: object
479     10,248,966
735     11,432,802
990      9,950,539
1246    10,835,532
1502    13,064,823
Name: Imports for Month, dtype: object
Total for Month: Mean = 20364901.14, Median = 21090337.50, Std Dev = 2824152.89
Exports for Month: Mean = 6835683.52, Median = 6972967.00, Std Dev = 1199750.30
Imports for Month: Mean = 13529217.64, Median = 13486813.50, Std Dev = 2064411.04</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-13-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-13-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-13-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:        Total for Month   R-squared:                       0.391
Model:                            OLS   Adj. R-squared:                  0.380
Method:                 Least Squares   F-statistic:                     35.98
Date:                Sun, 08 Dec 2024   Prob (F-statistic):           1.53e-07
Time:                        22:21:57   Log-Likelihood:                -928.92
No. Observations:                  58   AIC:                             1862.
Df Residuals:                      56   BIC:                             1866.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const      -2.529e+09   4.25e+08     -5.950      0.000   -3.38e+09   -1.68e+09
Year        1.262e+06    2.1e+05      5.998      0.000     8.4e+05    1.68e+06
==============================================================================
Omnibus:                        4.636   Durbin-Watson:                   1.239
Prob(Omnibus):                  0.098   Jarque-Bera (JB):                3.719
Skew:                           0.590   Prob(JB):                        0.156
Kurtosis:                       3.382   Cond. No.                     2.94e+06
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 2.94e+06. This might indicate that there are
strong multicollinearity or other numerical problems.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\jonca\AppData\Local\Temp\ipykernel_3880\2422938012.py:118: FutureWarning: 'Y' is deprecated and will be removed in a future version, please use 'YE' instead.
  annual_median = oceania_df[numeric_columns].resample('Y').median()</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-13-output-7.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="18e6a80b-0d71-43c7-aaeb-23358c4cb39f" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the regions and corresponding dataframes</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>regions <span class="op">=</span> [<span class="st">'Oceania'</span>, <span class="st">'Africa'</span>, <span class="st">'Europe'</span>, <span class="st">'Latin America'</span>, <span class="st">'North America'</span>, <span class="st">'Asia'</span>]</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>dataframes <span class="op">=</span> [oceania_df, africa_df, europe_df, latin_america_df, north_america_df, asia_df]</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a single figure for overlaying the plots</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate through each region and dataframe</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> region, df <span class="kw">in</span> <span class="bu">zip</span>(regions, dataframes):</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> df.empty:</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Plot each region's data in the same Axes</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>        plt.plot(df[<span class="st">'Year_Month'</span>], df[<span class="st">'Total for Month'</span>], marker<span class="op">=</span><span class="st">'o'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, label<span class="op">=</span>region)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Set labels and title</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Year_Month'</span>)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Total for Month'</span>)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Total for Month Comparison Across Regions'</span>)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Rotate x-axis labels for better readability</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Add grid and legend for clarity</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust the layout</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="f1c0e827-c47e-40e6-bc10-a235621cb44d" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the regions and corresponding dataframes</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>regions <span class="op">=</span> [<span class="st">'Oceania'</span>, <span class="st">'Africa'</span>, <span class="st">'Europe'</span>, <span class="st">'Latin America'</span>, <span class="st">'North America'</span>, <span class="st">'Asia'</span>]</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>dataframes <span class="op">=</span> [oceania_df, africa_df, europe_df, latin_america_df, north_america_df, asia_df]</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a single figure for overlaying the plots</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate through each region and dataframe</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> region, df <span class="kw">in</span> <span class="bu">zip</span>(regions, dataframes):</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> df.empty:</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Plot each region's data in the same Axes with logarithmic y-axis</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>        plt.plot(df[<span class="st">'Year_Month'</span>], df[<span class="st">'Total for Month'</span>], marker<span class="op">=</span><span class="st">'o'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, label<span class="op">=</span>region)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Set labels and title</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Year_Month'</span>)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Total for Month (Log scale)'</span>)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Total for Month Comparison Across Regions (Logarithmic Scale)'</span>)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Rotate x-axis labels for better readability</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Set y-axis to logarithmic scale</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>plt.yscale(<span class="st">'log'</span>)</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Add grid and legend for clarity</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, which<span class="op">=</span><span class="st">"both"</span>, ls<span class="op">=</span><span class="st">"--"</span>)  <span class="co"># Show grid for both major and minor ticks</span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust the layout</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="1c470cd5-6787-4ede-bab5-90a4339ebadd" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load democracy data into df_dem</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>file_path2 <span class="op">=</span> <span class="vs">r"C:\Users\jonca\Downloads\New Final Project\democracy-index-eiu\democracy-index-eiu.csv"</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>df_dem <span class="op">=</span> pd.read_csv(file_path2)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>file_path <span class="op">=</span> <span class="st">'C:/Users/jonca/Downloads/New Final Project/All Trade Information/Everything.xlsx'</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_excel(file_path) <span class="co"># Use smaller data types where possible</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the trade data with the democracy data on country and year</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>df_merged <span class="op">=</span> df.merge(</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    df_dem,</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    left_on<span class="op">=</span>[<span class="st">'Country/region'</span>, <span class="st">'Year'</span>],</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    right_on<span class="op">=</span>[<span class="st">'Entity'</span>, <span class="st">'Year'</span>],</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">'inner'</span>  <span class="co"># Inner join automatically removes non-matching entries</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Display merged and filtered data</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_merged.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        Source Month  Month_num  Year Country/region Total for Month  \
0  Jan_Feb.xls   Jan          1  2019     Bangladesh       2,265,823   
1  Jan_Feb.xls   Jan          1  2019         Bhutan           1,556   
2  Jan_Feb.xls   Jan          1  2019       Cambodia       1,151,581   
3  Jan_Feb.xls   Jan          1  2019         Cyprus         179,927   
4  Jan_Feb.xls   Jan          1  2019          India      12,214,581   

  Total YTD Exports for Month Exports YTD Imports for Month Imports YTD  \
0       NaN         2,128,760         NaN           137,063         NaN   
1       NaN             1,555         NaN                 1         NaN   
2       NaN           953,495         NaN           198,086         NaN   
3       NaN           178,179         NaN             1,747         NaN   
4       NaN         9,616,049         NaN         2,598,532         NaN   

  Percentage Change YoY Exports YoY change Imports YoY change      Entity  \
0                 -22.6              -22.8              -19.9  Bangladesh   
1                  11.8               11.9              -68.3      Bhutan   
2                  -2.9               -3.6                0.2    Cambodia   
3                 129.9              155.7              -79.6      Cyprus   
4                 -13.7              -13.9              -13.0       India   

  Code  Democracy score  
0  BGD             5.88  
1  BTN             5.30  
2  KHM             3.53  
3  CYP             7.59  
4  IND             6.90  </code></pre>
</div>
</div>
<div id="9295efcd-27be-47a7-a5ed-ed16c19f775d" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to convert column with potential non-string types to strings, clean, and convert to numeric</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_and_convert(column):</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert entire column to string, in case there are already numeric values or NaN</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    cleaned_column <span class="op">=</span> df_merged[column].astype(<span class="bu">str</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove commas</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    cleaned_column <span class="op">=</span> cleaned_column.<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Replace dash with NaN</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    cleaned_column <span class="op">=</span> cleaned_column.replace(<span class="st">'-'</span>, np.nan)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to float</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cleaned_column.astype(<span class="bu">float</span>)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure df_merged is your correct DataFrame</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the function to the specified columns</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>columns_to_clean <span class="op">=</span> [<span class="st">'Total for Month'</span>, <span class="st">'Exports for Month'</span>, <span class="st">'Imports for Month'</span>, <span class="st">'Democracy score'</span>]</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> columns_to_clean:</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    df_merged[column] <span class="op">=</span> clean_and_convert(column)</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the cleaned DataFrame</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_merged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           Source Month  Month_num  Year Country/region  Total for Month  \
0     Jan_Feb.xls   Jan          1  2019     Bangladesh        2265823.0   
1     Jan_Feb.xls   Jan          1  2019         Bhutan           1556.0   
2     Jan_Feb.xls   Jan          1  2019       Cambodia        1151581.0   
3     Jan_Feb.xls   Jan          1  2019         Cyprus         179927.0   
4     Jan_Feb.xls   Jan          1  2019          India       12214581.0   
...           ...   ...        ...   ...            ...              ...   
6688      Dec.xls   Dec         12  2023       Suriname          31536.0   
6689      Dec.xls   Dec         12  2023        Uruguay         459396.0   
6690      Dec.xls   Dec         12  2023  United States       57181510.0   
6691      Dec.xls   Dec         12  2023           Fiji          52279.0   
6692      Dec.xls   Dec         12  2023    New Zealand        1653832.0   

        Total YTD  Exports for Month  Exports YTD  Imports for Month  \
0             NaN          2128760.0          NaN           137063.0   
1             NaN             1555.0          NaN                1.0   
2             NaN           953495.0          NaN           198086.0   
3             NaN           178179.0          NaN             1747.0   
4             NaN          9616049.0          NaN          2598532.0   
...           ...                ...          ...                ...   
6688      384,091            28390.0      329,534             3146.0   
6689    5,317,224           253603.0    2,969,226           205793.0   
6690  664,450,816         42243658.0  500,290,654         14937852.0   
6691      526,126            50840.0      505,815             1439.0   
6692   21,360,224           654116.0    7,872,466           999716.0   

      Imports YTD Percentage Change YoY Exports YoY change Imports YoY change  \
0             NaN                 -22.6              -22.8              -19.9   
1             NaN                  11.8               11.9              -68.3   
2             NaN                  -2.9               -3.6                0.2   
3             NaN                 129.9              155.7              -79.6   
4             NaN                 -13.7              -13.9              -13.0   
...           ...                   ...                ...                ...   
6688       54,557                   7.7                6.0               19.1   
6689    2,347,998                 -28.1                1.0              -47.3   
6690  164,160,162                 -11.6              -13.1               -6.8   
6691       20,311                  -1.2                3.4              -53.1   
6692   13,487,758                 -14.7              -13.2              -15.5   

             Entity Code  Democracy score  
0        Bangladesh  BGD             5.88  
1            Bhutan  BTN             5.30  
2          Cambodia  KHM             3.53  
3            Cyprus  CYP             7.59  
4             India  IND             6.90  
...             ...  ...              ...  
6688       Suriname  SUR             6.88  
6689        Uruguay  URY             8.66  
6690  United States  USA             7.85  
6691           Fiji  FJI             5.55  
6692    New Zealand  NZL             9.61  

[6693 rows x 17 columns]</code></pre>
</div>
</div>
<div id="83fcc1b9-2327-47b8-8634-06f90e4f0472" class="cell" data-execution_count="20">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Group data by year</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>groups <span class="op">=</span> df.groupby(<span class="st">'Year'</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a figure with subplots, one for each year</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>num_years <span class="op">=</span> <span class="bu">len</span>(groups)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>, num_years, figsize<span class="op">=</span>(<span class="dv">5</span> <span class="op">*</span> num_years, <span class="dv">5</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over each year and its corresponding data</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax, (year, group) <span class="kw">in</span> <span class="bu">zip</span>(axs, groups):</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure non-zero values for log transformation</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    group <span class="op">=</span> group[group[<span class="st">'Exports for Month'</span>] <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add a constant (intercept) to the model for regression</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>    group[<span class="st">'Intercept'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Log-transform the 'Exports_for_Month'</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>    group[<span class="st">'Log_Exports'</span>] <span class="op">=</span> np.log(group[<span class="st">'Exports for Month'</span>])</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the dependent and independent variables</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> group[[<span class="st">'Intercept'</span>, <span class="st">'Democracy score'</span>]]</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> group[<span class="st">'Log_Exports'</span>]</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform the regression</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> sm.OLS(Y, X).fit()</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Prepare data for plotting (using exponential to revert the log transformation for the line)</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>    exp_preds <span class="op">=</span> np.exp(model.predict(X))</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the original data and the regression line</span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>    ax.scatter(group[<span class="st">'Democracy score'</span>], group[<span class="st">'Exports for Month'</span>], color<span class="op">=</span><span class="st">'blue'</span>, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>    ax.plot(group[<span class="st">'Democracy score'</span>], exp_preds, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'Regression Line'</span>)</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set y-axis to logarithmic scale</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>    ax.set_yscale(<span class="st">'log'</span>)</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set title and labels</span></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'Year: </span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">'Democracy Score'</span>)</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Exports for Month'</span>)</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust layout for neatness</span></span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\jonca\AppData\Local\Temp\ipykernel_3880\705357528.py:19: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  group['Intercept'] = 1
C:\Users\jonca\AppData\Local\Temp\ipykernel_3880\705357528.py:22: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  group['Log_Exports'] = np.log(group['Exports for Month'])
C:\Users\jonca\AppData\Local\Temp\ipykernel_3880\705357528.py:19: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  group['Intercept'] = 1
C:\Users\jonca\AppData\Local\Temp\ipykernel_3880\705357528.py:22: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  group['Log_Exports'] = np.log(group['Exports for Month'])
C:\Users\jonca\AppData\Local\Temp\ipykernel_3880\705357528.py:19: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  group['Intercept'] = 1
C:\Users\jonca\AppData\Local\Temp\ipykernel_3880\705357528.py:22: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  group['Log_Exports'] = np.log(group['Exports for Month'])
C:\Users\jonca\AppData\Local\Temp\ipykernel_3880\705357528.py:19: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  group['Intercept'] = 1
C:\Users\jonca\AppData\Local\Temp\ipykernel_3880\705357528.py:22: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  group['Log_Exports'] = np.log(group['Exports for Month'])
C:\Users\jonca\AppData\Local\Temp\ipykernel_3880\705357528.py:19: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  group['Intercept'] = 1
C:\Users\jonca\AppData\Local\Temp\ipykernel_3880\705357528.py:22: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  group['Log_Exports'] = np.log(group['Exports for Month'])</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/cell-18-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>